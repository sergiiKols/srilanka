# ‚úÖ –õ–û–ö–ê–¶–ò–Ø –° –í–ê–õ–ò–î–ê–¶–ò–ï–ô: –ó–ê–í–ï–†–®–ï–ù–û

**–î–∞—Ç–∞:** 2026-01-28  
**–°—Ç–∞—Ç—É—Å:** üéâ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

---

## üéØ –ß–¢–û –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

### **1. –ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é** ‚úÖ
- –§–æ—Ä–º–∞ —Ç–µ–ø–µ—Ä—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–∞ **–∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ**
- –¢–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å —Ä—É—Å—Å–∫–∏–º Telegram –ø–µ—Ä–µ–∫–ª—é—á–∞—é—Ç—Å—è –Ω–∞ RU
- –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ ‚Üí EN

### **2. –í—ã–±–æ—Ä –∏–∑ 7 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤** ‚úÖ
- üèñÔ∏è Unawatuna ‚Äî Beautiful beach, diving, restaurants
- üêã Mirissa ‚Äî Whale watching, surfing, beach parties
- üèÑ Hikkaduwa ‚Äî Surfing, coral reef, nightlife
- üê¢ Tangalle ‚Äî Quiet beaches, turtles, relaxation
- üåä Weligama ‚Äî Surf school, beginner-friendly bay
- üè∞ Galle ‚Äî Historic fort, cultural center
- üßò Ahangama ‚Äî Surf spots, yoga retreats, cafes

### **3. –û–ø—Ü–∏—è "Other city" (–î—Ä—É–≥–æ–π –≥–æ—Ä–æ–¥)** ‚úÖ
- –í dropdown –¥–æ–±–∞–≤–ª–µ–Ω–∞ –æ–ø—Ü–∏—è **"‚ûï Other city"**
- –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è **–ø–æ–ª–µ –≤–≤–æ–¥–∞** –¥–ª—è –Ω–∞–∑–≤–∞–Ω–∏—è –≥–æ—Ä–æ–¥–∞

### **4. –í–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ Perplexity API** ‚úÖ
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞** —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É –ø–æ—Å–ª–µ –≤–≤–æ–¥–∞
- **Debounce** ‚Äî –Ω–µ —Å–ø–∞–º–∏—Ç API –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Å–∏–º–≤–æ–ª–µ
- **Fallback** –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—É—é –±–∞–∑—É 100+ –≥–æ—Ä–æ–¥–æ–≤, –µ—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- **Haptic feedback** –ø—Ä–∏ —É—Å–ø–µ—Ö–µ/–æ—à–∏–±–∫–µ

### **5. –í–∏–∑—É–∞–ª—å–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏** ‚úÖ
- ‚è≥ **Validating city...** ‚Äî —Å–∏–Ω–∏–π (–ø—Ä–æ–≤–µ—Ä–∫–∞)
- ‚ùå **City not found** ‚Äî –∫—Ä–∞—Å–Ω—ã–π (–æ—à–∏–±–∫–∞)
- ‚úÖ **City confirmed** ‚Äî –∑–µ–ª—ë–Ω—ã–π (—É—Å–ø–µ—Ö)

---

## üìä –ö–ê–ö –≠–¢–û –†–ê–ë–û–¢–ê–ï–¢

### **–°—Ü–µ–Ω–∞—Ä–∏–π 1: –í—ã–±–æ—Ä –∏–∑ —Å–ø–∏—Å–∫–∞**
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ñ–æ—Ä–º—É
2. –í–∏–¥–∏—Ç dropdown "Location"
3. –í—ã–±–∏—Ä–∞–µ—Ç "Unawatuna ‚Äî Beautiful beach..."
4. ‚úÖ –õ–æ–∫–∞—Ü–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
5. –ü—Ä–æ–≥—Ä–µ—Å—Å: 14%
```

### **–°—Ü–µ–Ω–∞—Ä–∏–π 2: –°–≤–æ–π –≥–æ—Ä–æ–¥ (—É—Å–ø–µ—à–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è)**
```
1. –í—ã–±–∏—Ä–∞–µ—Ç "‚ûï Other city"
2. –ü–æ—è–≤–ª—è–µ—Ç—Å—è –ø–æ–ª–µ –≤–≤–æ–¥–∞ "Enter city name in Sri Lanka"
3. –í–≤–æ–¥–∏—Ç: "Negombo"
4. [–ü–∞—É–∑–∞ 1 —Å–µ–∫—É–Ω–¥–∞]
5. ‚è≥ Validating city...
6. [–ó–∞–ø—Ä–æ—Å –∫ Perplexity API]
7. ‚úÖ City confirmed
8. –ü—Ä–æ–≥—Ä–µ—Å—Å: 14%
```

### **–°—Ü–µ–Ω–∞—Ä–∏–π 3: –°–≤–æ–π –≥–æ—Ä–æ–¥ (–æ—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏)**
```
1. –í—ã–±–∏—Ä–∞–µ—Ç "‚ûï Other city"
2. –í–≤–æ–¥–∏—Ç: "Bangkok" (–Ω–µ –≤ –®—Ä–∏-–õ–∞–Ω–∫–µ!)
3. [–ü–∞—É–∑–∞ 1 —Å–µ–∫—É–Ω–¥–∞]
4. ‚è≥ Validating city...
5. [–ó–∞–ø—Ä–æ—Å –∫ Perplexity API]
6. ‚ùå City "Bangkok" not found in Sri Lanka. Please check the name.
7. –ü–æ–ª–µ –ø–æ–¥—Å–≤–µ—á–µ–Ω–æ –∫—Ä–∞—Å–Ω—ã–º
8. –ü—Ä–æ–≥—Ä–µ—Å—Å: 0% (–ª–æ–∫–∞—Ü–∏—è –Ω–µ –∑–∞—Å—á–∏—Ç–∞–Ω–∞)
```

### **–°—Ü–µ–Ω–∞—Ä–∏–π 4: Fallback (–µ—Å–ª–∏ Perplexity –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)**
```
1. –í—ã–±–∏—Ä–∞–µ—Ç "‚ûï Other city"
2. –í–≤–æ–¥–∏—Ç: "Colombo"
3. [–ü–∞—É–∑–∞ 1 —Å–µ–∫—É–Ω–¥–∞]
4. ‚è≥ Validating city...
5. [Perplexity API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω]
6. [Fallback: –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑–µ 100+ –≥–æ—Ä–æ–¥–æ–≤]
7. ‚úÖ City confirmed (–Ω–∞–π–¥–µ–Ω–æ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑–µ)
```

---

## üîß –¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø

### **–§–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã/–∏–∑–º–µ–Ω–µ–Ω—ã:**

1. ‚úÖ `src/utils/tenantTranslations.ts`
   - –ò–∑–º–µ–Ω—ë–Ω —è–∑—ã–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `'ru'` ‚Üí `'en'`
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è "Other city"

2. ‚úÖ `src/components/TenantRequestForm.tsx`
   - –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–æ—Å—Ç–æ—è–Ω–∏—è: `showCustomCity`, `customCity`, `isValidatingCity`
   - –§—É–Ω–∫—Ü–∏—è `validateCustomCity()` ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ API
   - –§—É–Ω–∫—Ü–∏—è `handleCustomCityChange()` ‚Äî debounced –≤–≤–æ–¥
   - –£—Å–ª–æ–≤–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –ø–æ–ª—è –≤–≤–æ–¥–∞

3. ‚úÖ `src/styles/tenant-form.css`
   - –°—Ç–∏–ª–∏ –¥–ª—è `.custom-city-input`
   - –°—Ç–∏–ª–∏ –¥–ª—è `.input-error`
   - –°—Ç–∏–ª–∏ –¥–ª—è `.validation-status` (validating/error/success)

4. ‚úÖ `src/pages/api/validate-city.ts` (–ù–û–í–´–ô!)
   - POST endpoint `/api/validate-city`
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Perplexity API
   - Fallback –≤–∞–ª–∏–¥–∞—Ü–∏—è (100+ –≥–æ—Ä–æ–¥–æ–≤)
   - –ê–ª–≥–æ—Ä–∏—Ç–º –õ–µ–≤–µ–Ω—à—Ç–µ–π–Ω–∞ –¥–ª—è –æ–ø–µ—á–∞—Ç–æ–∫

5. ‚úÖ `.env.example`
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `PERPLEXITY_API_KEY`

---

## üîë –ù–ê–°–¢–†–û–ô–ö–ê PERPLEXITY API

### **–ü–æ–ª—É—á–µ–Ω–∏–µ API –∫–ª—é—á–∞:**

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ https://www.perplexity.ai/
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ API Settings
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π API –∫–ª—é—á
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–ª—é—á

### **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –ø—Ä–æ–µ–∫—Ç:**

```bash
# –í —Ñ–∞–π–ª .env (–Ω–µ .env.example!)
PERPLEXITY_API_KEY=pplx-xxxxxxxxxxxxxxxxxxxxxx
```

### **–ü—Ä–æ–≤–µ—Ä–∫–∞:**

```bash
# Restart dev server
node node_modules\astro\astro.js dev
```

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### **1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–æ—Ä–º—É:**
```
http://localhost:4324/test-tenant-form
```

**–û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É:** Ctrl+F5

### **2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —è–∑—ã–∫:**
- ‚úÖ –§–æ—Ä–º–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–∞ **–∞–Ω–≥–ª–∏–π—Å–∫–æ–º**
- ‚úÖ –ó–∞–≥–æ–ª–æ–≤–æ–∫: "üìç Where are you looking?"

### **3. –¢–µ—Å—Ç 1: –í—ã–±–æ—Ä –∏–∑ —Å–ø–∏—Å–∫–∞**
```
1. Dropdown ‚Üí "Unawatuna ‚Äî Beautiful beach..."
2. ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å: 14%
```

### **4. –¢–µ—Å—Ç 2: –°–≤–æ–π –≥–æ—Ä–æ–¥ (–≤–∞–ª–∏–¥–Ω—ã–π)**
```
1. Dropdown ‚Üí "‚ûï Other city"
2. –ü–æ—è–≤–∏–ª–æ—Å—å –ø–æ–ª–µ –≤–≤–æ–¥–∞
3. –í–≤–µ–¥–∏—Ç–µ: "Negombo"
4. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 1 —Å–µ–∫—É–Ω–¥—É
5. ‚è≥ Validating city...
6. ‚úÖ City confirmed (–∑–µ–ª—ë–Ω—ã–π)
7. –ü—Ä–æ–≥—Ä–µ—Å—Å: 14%
```

### **5. –¢–µ—Å—Ç 3: –°–≤–æ–π –≥–æ—Ä–æ–¥ (–Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π)**
```
1. Dropdown ‚Üí "‚ûï Other city"
2. –í–≤–µ–¥–∏—Ç–µ: "Moscow"
3. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 1 —Å–µ–∫—É–Ω–¥—É
4. ‚ùå City "Moscow" not found in Sri Lanka
5. –ü–æ–ª–µ –∫—Ä–∞—Å–Ω–æ–µ
6. –ü—Ä–æ–≥—Ä–µ—Å—Å: 0%
```

### **6. –¢–µ—Å—Ç 4: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —è–∑—ã–∫–∞**
```
1. –ù–∞–∂–º–∏—Ç–µ "RU" –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É
2. Dropdown ‚Üí "‚ûï –î—Ä—É–≥–æ–π –≥–æ—Ä–æ–¥"
3. –í–≤–µ–¥–∏—Ç–µ: "–ö–æ–ª–æ–º–±–æ"
4. ‚úÖ –ì–æ—Ä–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω
```

### **7. –¢–µ—Å—Ç 5: Fallback (–±–µ–∑ API –∫–ª—é—á–∞)**
```
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ PERPLEXITY_API_KEY –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
2. Dropdown ‚Üí "‚ûï Other city"
3. –í–≤–µ–¥–∏—Ç–µ: "Colombo"
4. –î–æ–ª–∂–Ω–∞ —Å—Ä–∞–±–æ—Ç–∞—Ç—å fallback –≤–∞–ª–∏–¥–∞—Ü–∏—è
5. ‚úÖ City confirmed (–∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –±–∞–∑—ã)
```

---

## üìã –°–ü–ò–°–û–ö –ì–û–†–û–î–û–í –í FALLBACK (100+)

### **–¢—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ:**
- Unawatuna, Mirissa, Hikkaduwa, Tangalle, Weligama, Galle, Ahangama
- Arugam Bay, Nilaveli, Passikudah, Trincomalee
- Ella, Nuwara Eliya, Kandy, Sigiriya

### **–ö—Ä—É–ø–Ω—ã–µ –≥–æ—Ä–æ–¥–∞:**
- Colombo, Negombo, Jaffna, Batticaloa, Matara, Hambantota
- Anuradhapura, Polonnaruwa, Kurunegala, Ratnapura

### **–ò –µ—â—ë 80+ –≥–æ—Ä–æ–¥–æ–≤** (—Å–º. `src/pages/api/validate-city.ts`)

---

## üîç –ü–†–û–í–ï–†–ö–ê –ß–ï–†–ï–ó PERPLEXITY

### **–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ –∫ API:**

```json
POST https://api.perplexity.ai/chat/completions

{
  "model": "llama-3.1-sonar-small-128k-online",
  "messages": [
    {
      "role": "system",
      "content": "You are a geographic expert on Sri Lanka. Answer concisely with yes/no."
    },
    {
      "role": "user",
      "content": "Does a city or town named \"Negombo\" exist in Sri Lanka? Answer only \"yes\" or \"no\"."
    }
  ],
  "temperature": 0.1,
  "max_tokens": 100
}
```

### **–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "choices": [{
    "message": {
      "content": "Yes, Negombo is a city in Sri Lanka located north of Colombo."
    }
  }]
}
```

---

## ‚ö†Ô∏è –ò–ó–í–ï–°–¢–ù–´–ï –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø

### **1. Perplexity API —Ç—Ä–µ–±—É–µ—Ç –∫–ª—é—á**
- –ë–µ–∑ –∫–ª—é—á–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç fallback (100+ –≥–æ—Ä–æ–¥–æ–≤)
- –° –∫–ª—é—á–æ–º ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª—é–±–æ–≥–æ –≥–æ—Ä–æ–¥–∞ –æ–Ω–ª–∞–π–Ω

### **2. Debounce 1 —Å–µ–∫—É–Ω–¥–∞**
- –ß—Ç–æ–±—ã –Ω–µ —Å–ø–∞–º–∏—Ç—å API –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Å–∏–º–≤–æ–ª–µ
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –∑–∞–∫–æ–Ω—á–∏—Ç—å –≤–≤–æ–¥

### **3. Fallback –Ω–µ –∏–¥–µ–∞–ª–µ–Ω**
- –ó–Ω–∞–µ—Ç —Ç–æ–ª—å–∫–æ ~100 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
- –î–ª—è —Ä–µ–¥–∫–∏—Ö –≥–æ—Ä–æ–¥–æ–≤ –Ω—É–∂–µ–Ω Perplexity API

---

## üìä –û–ë–ù–û–í–õ–Å–ù–ù–ê–Ø –°–¢–†–£–ö–¢–£–†–ê –ë–î

–í `tenant_requests` —Ç–µ–ø–µ—Ä—å –ª–æ–∫–∞—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å:
- `'unawatuna'` ‚Äî –∏–∑ —Å–ø–∏—Å–∫–∞
- `'custom:Negombo'` ‚Äî –≤–≤–µ–¥–µ–Ω–æ –≤—Ä—É—á–Ω—É—é

SQL –º–∏–≥—Ä–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ (–Ω–æ –¥–æ–ø—É—Å–∫–∞–µ—Ç –ª—é–±—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è custom –≥–æ—Ä–æ–¥–æ–≤).

---

## ‚úÖ –ß–ï–ö–õ–ò–°–¢ –ì–û–¢–û–í–ù–û–°–¢–ò

- [x] –ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- [x] 7 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ –≤ dropdown
- [x] –û–ø—Ü–∏—è "Other city"
- [x] –ü–æ–ª–µ –≤–≤–æ–¥–∞ –≥–æ—Ä–æ–¥–∞
- [x] Debounced –≤–∞–ª–∏–¥–∞—Ü–∏—è (1 —Å–µ–∫)
- [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Perplexity API
- [x] Fallback –≤–∞–ª–∏–¥–∞—Ü–∏—è (100+ –≥–æ—Ä–æ–¥–æ–≤)
- [x] –í–∏–∑—É–∞–ª—å–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã (validating/error/success)
- [x] Haptic feedback
- [x] –ü–µ—Ä–µ–≤–æ–¥—ã RU/EN
- [x] –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

**–ì–û–¢–û–í–û –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ! üéâ**

–û—Ç–∫—Ä–æ–π—Ç–µ: http://localhost:4324/test-tenant-form

*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2026-01-28*
