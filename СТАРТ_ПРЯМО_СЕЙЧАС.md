# üöÄ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢ - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏

## ‚ö° –ß–¢–û –°–õ–£–ß–ò–õ–û–°–¨:

1. ‚ùå –§—É–Ω–∫—Ü–∏—è `soft_delete_property` –ù–ï –°–û–ó–î–ê–ù–ê –≤ –±–∞–∑–µ
2. ‚ùå –û—à–∏–±–∫–∞: `column "square_meters" does not exist`
3. ‚ùå PersonalMap —É–¥–∞–ª—è–µ—Ç –æ–±—ä–µ–∫—Ç—ã —Ç–æ–ª—å–∫–æ –∏–∑ state, –Ω–µ –≤—ã–∑—ã–≤–∞—è API
4. ‚ùå "Show Archived (0)" - –Ω–µ—Ç –∞—Ä—Ö–∏–≤–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤

---

## ‚úÖ –ß–¢–û –ò–°–ü–†–ê–í–õ–ï–ù–û:

### 1. –§—É–Ω–∫—Ü–∏—è `soft_delete_property` –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞
- –£–±—Ä–∞–Ω—ã –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–ª–æ–Ω–∫–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∞ RLS –ø–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è anon
- –ì–æ—Ç–æ–≤–∞ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –≤ –±–∞–∑–µ

### 2. PersonalMap —Ç–µ–ø–µ—Ä—å –≤—ã–∑—ã–≤–∞–µ—Ç API
- –î–æ–±–∞–≤–ª–µ–Ω `fetch()` –≤—ã–∑–æ–≤ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ –µ—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å

---

## üéØ –î–í–ê –ü–†–û–°–¢–´–• –®–ê–ì–ê:

### –®–ê–ì 1: SQL (2 –º–∏–Ω—É—Ç—ã)
1. –û—Ç–∫—Ä–æ–π—Ç–µ **Supabase SQL Editor**
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Ñ–∞–π–ª: **`FIX_ARCHIVE_FUNCTIONS.sql`**
3. –î–æ–∂–¥–∏—Ç–µ—Å—å: **‚úÖ –§–£–ù–ö–¶–ò–Ø –°–û–ó–î–ê–ù–ê!**

### –®–ê–ì 2: –¢–µ—Å—Ç (1 –º–∏–Ω—É—Ç–∞)
1. –û—Ç–∫—Ä–æ–π—Ç–µ PersonalMap –ª—é–±–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –£–¥–∞–ª–∏—Ç–µ –ª—é–±–æ–π –æ–±—ä–µ–∫—Ç
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
   ```
   üóëÔ∏è Deleting property: xxx
   ‚úÖ Property deleted from database
   ‚úÖ Property removed from map
   ```

---

## üéâ –ì–û–¢–û–í–û!

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è SQL:
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –Ω–∞ PersonalMap —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –û–±—ä–µ–∫—Ç—ã –∞—Ä—Ö–∏–≤–∏—Ä—É—é—Ç—Å—è –≤ –±–∞–∑–µ
- ‚úÖ Admin Panel –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∞—Ä—Ö–∏–≤
- ‚úÖ –ú–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ –±—É–¥—É—â–µ–º

---

## üìÅ –§–ê–ô–õ–´:

| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|-----------|
| **`FIX_ARCHIVE_FUNCTIONS.sql`** | ‚ö° –í—ã–ø–æ–ª–Ω–∏—Ç—å –≤ Supabase |
| `–ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø_–ê–†–•–ò–í–ê–¶–ò–ò_–ü–û–õ–ù–´–ï.md` | üìñ –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è |
| `–ë–´–°–¢–†–û–ï_–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï.md` | üöÄ –ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è |

---

## üìä –ü–†–û–í–ï–†–ö–ê:

```sql
-- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞:
SELECT EXISTS (
    SELECT 1 FROM pg_proc 
    WHERE proname = 'soft_delete_property'
) as "–§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞?";

-- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞—Ä—Ö–∏–≤–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã:
SELECT COUNT(*) as "–ê—Ä—Ö–∏–≤–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤" 
FROM archived_properties 
WHERE can_restore = TRUE;
```

---

**–í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å - —ç—Ç–æ –∑–∞–π–º—ë—Ç 2 –º–∏–Ω—É—Ç—ã!** ‚ö°
