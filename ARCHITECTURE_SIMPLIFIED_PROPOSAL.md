# üéØ –£–ü–†–û–©–Å–ù–ù–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê: Geo-Radius –ü–æ–¥—Ö–æ–¥

**–î–∞—Ç–∞:** 25 —è–Ω–≤–∞—Ä—è 2026  
**–°—Ç–∞—Ç—É—Å:** –ü–†–ï–î–õ–û–ñ–ï–ù–ò–ï (–¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è)  
**–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞—Ü–∏—é –∫–ª–∏–µ–Ω—Ç–∞ –∫–∞–∫ —Ü–µ–Ω—Ç—Ä –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ —Ä–∞–¥–∏—É—Å–µ 20–∫–º

---

## üìã –°–£–¢–¨ –ò–ó–ú–ï–ù–ï–ù–ò–ô

### –ë—ã–ª–æ (—Å–ª–æ–∂–Ω–æ):
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1. –ö–ª–∏–µ–Ω—Ç –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É (–¥–∞—Ç—ã, –ª–æ–∫–∞—Ü–∏—è, –±—é–¥–∂–µ—Ç)     ‚îÇ
‚îÇ 2. –°–æ–∑–¥–∞—ë—Ç—Å—è rental_task                               ‚îÇ
‚îÇ 3. Matching –∞–ª–≥–æ—Ä–∏—Ç–º –∏—â–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –æ–±—ä–µ–∫—Ç—ã          ‚îÇ
‚îÇ 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ availability –ø–æ –¥–∞—Ç–∞–º                      ‚îÇ
‚îÇ 5. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –º–Ω–æ–∂–µ—Å—Ç–≤—É –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤                 ‚îÇ
‚îÇ 6. –ü–æ–∫–∞–∑ –Ω–∞ –∫–∞—Ä—Ç–µ                                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–¢–∞–±–ª–∏—Ü—ã –ë–î: rental_tasks, rental_bookings, rental_availability,
            rental_responses, properties, offers + matching logic
```

### –°—Ç–∞–Ω–µ—Ç (–ø—Ä–æ—Å—Ç–æ):
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1. –ö–ª–∏–µ–Ω—Ç —É–∫–∞–∑—ã–≤–∞–µ—Ç –ª–æ–∫–∞—Ü–∏—é –≤ Telegram                 ‚îÇ
‚îÇ 2. –°–∏—Å—Ç–µ–º–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –æ–±—ä–µ–∫—Ç—ã –≤ —Ä–∞–¥–∏—É—Å–µ 20–∫–º           ‚îÇ
‚îÇ 3. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–π –∫–∞—Ä—Ç–µ                    ‚îÇ
‚îÇ 4. –ö–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –∫–ª–∏–∫–Ω—É—Ç—å –¥—Ä—É–≥—É—é —Ç–æ—á–∫—É                 ‚îÇ
‚îÇ 5. –°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ä–∞–¥–∏—É—Å –æ—Ç –Ω–æ–≤–æ–π —Ç–æ—á–∫–∏        ‚îÇ
‚îÇ 6. –ö–ª–∏–µ–Ω—Ç –≤–∏–¥–∏—Ç –∫–æ–Ω—Ç–∞–∫—Ç—ã –∏ —Å–≤—è–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–¢–∞–±–ª–∏—Ü—ã –ë–î: properties, offers, user_map_sessions + –ø—Ä–æ—Å—Ç–æ–π geo-query
```

---

## üóÑÔ∏è –ò–ó–ú–ï–ù–ï–ù–ò–Ø –í –ë–ê–ó–ï –î–ê–ù–ù–´–•

### ‚ùå –£–î–ê–õ–Ø–ï–ú (–Ω–µ –Ω—É–∂–Ω—ã –±–æ–ª—å—à–µ):
```sql
-- –≠—Ç–∏ —Ç–∞–±–ª–∏—Ü—ã —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –∏–∑–±—ã—Ç–æ—á–Ω—ã–º–∏
rental_tasks           -- –ù–µ –Ω—É–∂–Ω–∞: –Ω–µ—Ç matching
rental_bookings        -- –ù–µ –Ω—É–∂–Ω–∞: –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–Ω–µ —Å–∏—Å—Ç–µ–º—ã
rental_availability    -- –ù–µ –Ω—É–∂–Ω–∞: –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞—Ç—ã
rental_responses       -- –ù–µ –Ω—É–∂–Ω–∞: —Å–≤—è–∑—å –Ω–∞–ø—Ä—è–º—É—é –≤ Telegram
matching_criteria      -- –ù–µ –Ω—É–∂–Ω–∞: –Ω–µ—Ç —Å–ª–æ–∂–Ω–æ–≥–æ matching
```

### ‚úÖ –û–°–¢–ê–í–õ–Ø–ï–ú (–æ—Å–Ω–æ–≤–∞):
```sql
-- –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
properties             -- –û–±—ä–µ–∫—Ç—ã –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏
offers                 -- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –æ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤
landlords              -- –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∏ (—Å telegram –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏)
users                  -- –ö–ª–∏–µ–Ω—Ç—ã

-- –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—è
ALTER TABLE offers ADD COLUMN telegram_contact VARCHAR(100);
ALTER TABLE offers ADD COLUMN landlord_telegram_id BIGINT;
```

### üÜï –î–û–ë–ê–í–õ–Ø–ï–ú (–¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –∫–∞—Ä—Ç):
```sql
-- –°–µ—Å—Å–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –∫–∞—Ä—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤
CREATE TABLE user_map_sessions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES users(id),
  
  -- –¢–µ–∫—É—â–∏–π —Ü–µ–Ω—Ç—Ä –∫–∞—Ä—Ç—ã
  center_lat DECIMAL(10, 8) NOT NULL,
  center_lng DECIMAL(11, 8) NOT NULL,
  
  -- –†–∞–¥–∏—É—Å –ø–æ–∏—Å–∫–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20–∫–º)
  radius_km INTEGER DEFAULT 20,
  
  -- –§–∏–ª—å—Ç—Ä—ã (–ø—Ä–æ—Å—Ç—ã–µ)
  min_price INTEGER,
  max_price INTEGER,
  property_types TEXT[], -- ['apartment', 'villa', 'room']
  amenities TEXT[],      -- ['wifi', 'pool', 'kitchen']
  
  -- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
  created_at TIMESTAMPTZ DEFAULT NOW(),
  last_accessed TIMESTAMPTZ DEFAULT NOW(),
  is_active BOOLEAN DEFAULT TRUE
);

-- –ò–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ geo-–ø–æ–∏—Å–∫–∞
CREATE INDEX idx_properties_location 
ON properties USING GIST (
  ll_to_earth(latitude, longitude)
);

-- –ò—Å—Ç–æ—Ä–∏—è –∫–ª–∏–∫–æ–≤ –Ω–∞ –∫–∞—Ä—Ç–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏)
CREATE TABLE map_click_history (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  session_id UUID REFERENCES user_map_sessions(id),
  lat DECIMAL(10, 8),
  lng DECIMAL(11, 8),
  clicked_at TIMESTAMPTZ DEFAULT NOW()
);
```

---

## üîå API ENDPOINTS

### –ë—ã–ª–æ (—Å–ª–æ–∂–Ω–æ):
```
POST /api/rental-tasks          # –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É
GET  /api/rental-tasks/:id      # –ü–æ–ª—É—á–∏—Ç—å –∑–∞–¥–∞—á—É
POST /api/matching/run          # –ó–∞–ø—É—Å—Ç–∏—Ç—å matching
GET  /api/rental-tasks/:id/matches  # –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
POST /api/rental-responses      # –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫ –æ—Ç–∫–ª–∏–∫–∞–µ—Ç—Å—è
```

### –°—Ç–∞–Ω–µ—Ç (–ø—Ä–æ—Å—Ç–æ):
```
POST /api/map/session           # –°–æ–∑–¥–∞—Ç—å —Å–µ—Å—Å–∏—é –∫–∞—Ä—Ç—ã
  Body: { user_id, initial_location: { lat, lng } }
  Returns: { session_id, center, properties_in_radius }

GET /api/map/properties         # –ü–æ–ª—É—á–∏—Ç—å –æ–±—ä–µ–∫—Ç—ã –≤ —Ä–∞–¥–∏—É—Å–µ
  Query: ?lat=X&lng=Y&radius=20&min_price=500&max_price=2000
  Returns: [ { id, name, lat, lng, price, contact, ... } ]

POST /api/map/recenter          # –ö–ª–∏–µ–Ω—Ç –∫–ª–∏–∫–Ω—É–ª –Ω–∞ –Ω–æ–≤—É—é —Ç–æ—á–∫—É
  Body: { session_id, new_lat, new_lng }
  Returns: { properties_in_radius }

GET /api/properties/:id/contact # –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞
  Returns: { telegram_username, telegram_link }
```

---

## üó∫Ô∏è FRONTEND –ò–ó–ú–ï–ù–ï–ù–ò–Ø

### Map Component (Map.tsx)
```typescript
// –ë–´–õ–û: –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã, –ø–æ—Ç–æ–º —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç
const [allProperties, setAllProperties] = useState([]);
const [filteredProperties, setFilteredProperties] = useState([]);

// –°–¢–ê–ù–ï–¢: –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ —Ä–∞–¥–∏—É—Å–µ
const [centerPoint, setCenterPoint] = useState({ lat, lng });
const [radius, setRadius] = useState(20); // –∫–º
const [propertiesInRadius, setPropertiesInRadius] = useState([]);

// –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∫–∞—Ä—Ç—É
const handleMapClick = async (newLat, newLng) => {
  setCenterPoint({ lat: newLat, lng: newLng });
  
  // –ó–∞–≥—Ä—É–∂–∞–µ–º –æ–±—ä–µ–∫—Ç—ã –≤ —Ä–∞–¥–∏—É—Å–µ –æ—Ç –Ω–æ–≤–æ–π —Ç–æ—á–∫–∏
  const properties = await fetch(
    `/api/map/properties?lat=${newLat}&lng=${newLng}&radius=${radius}`
  ).then(r => r.json());
  
  setPropertiesInRadius(properties);
};

// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å —Ä–∞–¥–∏—É—Å–∞ –Ω–∞ –∫–∞—Ä—Ç–µ
<Circle
  center={centerPoint}
  radius={radius * 1000} // –º–µ—Ç—Ä—ã
  pathOptions={{ color: 'blue', fillOpacity: 0.1 }}
/>
```

### Telegram Web App
```typescript
// –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∫–∞—Ä—Ç—ã –∏–∑ Telegram
const initializeMap = async () => {
  // –ü–æ–ª—É—á–∞–µ–º –ª–æ–∫–∞—Ü–∏—é –∏–∑ Telegram —Ñ–æ—Ä–º—ã –∏–ª–∏ –ø—Ä–æ—Ñ–∏–ª—è
  const userLocation = await getTelegramUserLocation();
  
  // –°–æ–∑–¥–∞—ë–º —Å–µ—Å—Å–∏—é –∫–∞—Ä—Ç—ã
  const session = await fetch('/api/map/session', {
    method: 'POST',
    body: JSON.stringify({
      user_id: telegramUser.id,
      initial_location: userLocation
    })
  }).then(r => r.json());
  
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞—Ä—Ç—É —Å –æ–±—ä–µ–∫—Ç–∞–º–∏
  renderMap(session.center, session.properties_in_radius);
};
```

---

## üéØ –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê –ù–û–í–û–ì–û –ü–û–î–•–û–î–ê

### 1. –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```
–ë—ã–ª–æ:   ~4 –Ω–µ–¥–µ–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
–°—Ç–∞–Ω–µ—Ç: ~1 –Ω–µ–¥–µ–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

–ü—Ä–∏—á–∏–Ω–∞: –£–±–∏—Ä–∞–µ–º 70% —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏
```

### 2. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
```
–ë—ã–ª–æ:   –ó–∞–≥—Ä—É–∂–∞–µ—Ç –í–°–ï –æ–±—ä–µ–∫—Ç—ã ‚Üí —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç
        (1000+ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –ø–∞–º—è—Ç–∏)

–°—Ç–∞–Ω–µ—Ç: –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ —Ä–∞–¥–∏—É—Å–µ 20–∫–º
        (–æ–±—ã—á–Ω–æ 10-100 –æ–±—ä–µ–∫—Ç–æ–≤)
        
–°–∫–æ—Ä–æ—Å—Ç—å: 10x –±—ã—Å—Ç—Ä–µ–µ
```

### 3. User Experience
```
–ë—ã–ª–æ:   –ö–ª–∏–µ–Ω—Ç –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É ‚Üí –∂–¥—ë—Ç matching ‚Üí 
        –ø–æ–ª—É—á–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã ‚Üí –º–æ–∂–µ—Ç –Ω–µ —É—Å—Ç—Ä–æ–∏—Ç—å

–°—Ç–∞–Ω–µ—Ç: –ö–ª–∏–µ–Ω—Ç –≤–∏–¥–∏—Ç –∫–∞—Ä—Ç—É ‚Üí –∫–ª–∏–∫–∞–µ—Ç –∫—É–¥–∞ —Ö–æ—á–µ—Ç ‚Üí 
        —Å—Ä–∞–∑—É –≤–∏–¥–∏—Ç —á—Ç–æ —Ä—è–¥–æ–º ‚Üí –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ
```

### 4. –ú–æ–±–∏–ª—å–Ω–æ—Å—Ç—å
```
–ë—ã–ª–æ:   –ú–Ω–æ–∂–µ—Å—Ç–≤–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –Ω–µ—É–¥–æ–±–Ω—ã –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º

–°—Ç–∞–Ω–µ—Ç: –ö–ª–∏–∫ –Ω–∞ –∫–∞—Ä—Ç–µ + 2-3 –ø—Ä–æ—Å—Ç—ã—Ö —Ñ–∏–ª—å—Ç—Ä–∞
        (–±—é–¥–∂–µ—Ç, —Ç–∏–ø –∂–∏–ª—å—è)
```

### 5. –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
```
–ë—ã–ª–æ:   Matching –∞–ª–≥–æ—Ä–∏—Ç–º –Ω–∞–≥—Ä—É–∂–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä
        –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –æ–±—ä–µ–∫—Ç–æ–≤

–°—Ç–∞–Ω–µ—Ç: –ü—Ä–æ—Å—Ç–æ–π geo-query —Å –∏–Ω–¥–µ–∫—Å–æ–º
        –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –æ—Ç–ª–∏—á–Ω–æ
```

---

## üîÑ FLOW: –ö–ê–ö –≠–¢–û –†–ê–ë–û–¢–ê–ï–¢

### –®–∞–≥ 1: –ö–ª–∏–µ–Ω—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç –∏–∑ Telegram
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç –±–æ—Ç @UnmissableRentalsBot
2. –ë–æ—Ç —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç: "–ì–¥–µ –∏—â–µ—Ç–µ –∂–∏–ª—å—ë?"
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ª–æ–∫–∞—Ü–∏—é –∏–ª–∏ –ø–∏—à–µ—Ç "Ubud, Bali"
4. –ë–æ—Ç —Å–æ–∑–¥–∞—ë—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é –∫–∞—Ä—Ç—É —Å —Ü–µ–Ω—Ç—Ä–æ–º –≤ —ç—Ç–æ–π —Ç–æ—á–∫–µ
5. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Å—ã–ª–∫—É: "üó∫Ô∏è –û—Ç–∫—Ä—ã—Ç—å –∫–∞—Ä—Ç—É"
```

### –®–∞–≥ 2: –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
```
1. WebApp –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å —Ü–µ–Ω—Ç—Ä–æ–º –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–π –ª–æ–∫–∞—Ü–∏–∏
2. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–∏–Ω—é—é –æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å —Ä–∞–¥–∏—É—Å–∞ 20–∫–º
3. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –≤ —Ä–∞–¥–∏—É—Å–µ
4. –ú–∞—Ä–∫–µ—Ä—ã –Ω–∞ –∫–∞—Ä—Ç–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç:
   - –¶–µ–Ω–∞
   - –¢–∏–ø (villa/apartment/room)
   - –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
```

### –®–∞–≥ 3: –ö–ª–∏–µ–Ω—Ç –∏—Å—Å–ª–µ–¥—É–µ—Ç –∫–∞—Ä—Ç—É
```
1. –ö–ª–∏–µ–Ω—Ç –≤–∏–¥–∏—Ç –æ–±—ä–µ–∫—Ç—ã –≤ —Ä–∞–¥–∏—É—Å–µ 20–∫–º
2. –ú–æ–∂–µ—Ç –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã:
   - –ë—é–¥–∂–µ—Ç: $500-$2000
   - –¢–∏–ø: villa, apartment
   - –£–¥–æ–±—Å—Ç–≤–∞: wifi, pool, kitchen
3. –ú–æ–∂–µ—Ç –∫–ª–∏–∫–Ω—É—Ç—å –Ω–∞ –¥—Ä—É–≥—É—é —Ç–æ—á–∫—É –∫–∞—Ä—Ç—ã
4. –°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±—ä–µ–∫—Ç—ã –æ—Ç –Ω–æ–≤–æ–π —Ç–æ—á–∫–∏
```

### –®–∞–≥ 4: –ö–ª–∏–µ–Ω—Ç –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏–π –æ–±—ä–µ–∫—Ç
```
1. –ö–ª–∏–∫–∞–µ—Ç –Ω–∞ –º–∞—Ä–∫–µ—Ä
2. –í–∏–¥–∏—Ç –¥–µ—Ç–∞–ª–∏:
   - –§–æ—Ç–æ
   - –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
   - –¶–µ–Ω–∞
   - –ö–æ–Ω—Ç–∞–∫—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞ (Telegram username)
3. –ù–∞–∂–∏–º–∞–µ—Ç "–°–≤—è–∑–∞—Ç—å—Å—è –≤ Telegram"
4. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —á–∞—Ç —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–º
5. –î–æ–≥–æ–≤–∞—Ä–∏–≤–∞–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é
```

---

## üìä –°–†–ê–í–ù–ï–ù–ò–ï: –ë–´–õ–û vs –°–¢–ê–ù–ï–¢

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ë—ã–ª–æ (—Å–ª–æ–∂–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞) | –°—Ç–∞–Ω–µ—Ç (geo-radius) | –í—ã–∏–≥—Ä—ã—à |
|----------|----------------------------|---------------------|---------|
| **–¢–∞–±–ª–∏—Ü –≤ –ë–î** | 8+ | 3-4 | 50% –ø—Ä–æ—â–µ |
| **API endpoints** | 10+ | 4-5 | 50% –ø—Ä–æ—â–µ |
| **–í—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏** | 3-4 –Ω–µ–¥–µ–ª–∏ | 1 –Ω–µ–¥–µ–ª—è | 3x –±—ã—Å—Ç—Ä–µ–µ |
| **–°–ª–æ–∂–Ω–æ—Å—Ç—å –∫–æ–¥–∞** | HIGH | LOW | 70% –ø—Ä–æ—â–µ |
| **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | –ú–µ–¥–ª–µ–Ω–Ω–æ (1000+ –æ–±—ä–µ–∫—Ç–æ–≤) | –ë—ã—Å—Ç—Ä–æ (10-100 –æ–±—ä–µ–∫—Ç–æ–≤) | 10x –±—ã—Å—Ç—Ä–µ–µ |
| **UX –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º** | –°–ª–æ–∂–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã | –ö–ª–∏–∫ –Ω–∞ –∫–∞—Ä—Ç–µ | –ù–∞–º–Ω–æ–≥–æ –ª—É—á—à–µ |
| **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** | –ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–∏ —Ä–æ—Å—Ç–µ | Geo-–∏–Ω–¥–µ–∫—Å —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è | –û—Ç–ª–∏—á–Ω–æ |

---

## ‚ö†Ô∏è –ß–¢–û –¢–ï–†–Ø–ï–ú?

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π matching
```
–ë—ã–ª–æ:   –°–∏—Å—Ç–µ–º–∞ —Å–∞–º–∞ –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –æ–±—ä–µ–∫—Ç—ã
–°—Ç–∞–Ω–µ—Ç: –ö–ª–∏–µ–Ω—Ç —Å–∞–º —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –Ω–∞ –∫–∞—Ä—Ç–µ

–í–µ—Ä–¥–∏–∫—Ç: ‚úÖ –û–ö–ï–ô - –∫–ª–∏–µ–Ω—Ç—É —Ç–∞–∫ –¥–∞–∂–µ —É–¥–æ–±–Ω–µ–µ
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ availability –ø–æ –¥–∞—Ç–∞–º
```
–ë—ã–ª–æ:   –°–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–±–æ–¥–Ω—ã–µ –Ω–∞ –¥–∞—Ç—ã
–°—Ç–∞–Ω–µ—Ç: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ, –∫–ª–∏–µ–Ω—Ç —É—Ç–æ—á–Ω—è–µ—Ç –ø—Ä–∏ –∫–æ–Ω—Ç–∞–∫—Ç–µ

–í–µ—Ä–¥–∏–∫—Ç: ‚úÖ –û–ö–ï–ô - –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å—ë —Ä–∞–≤–Ω–æ –≤–Ω–µ —Å–∏—Å—Ç–µ–º—ã
```

### 3. –°–∏—Å—Ç–µ–º–∞ –æ—Ç–∫–ª–∏–∫–æ–≤ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤
```
–ë—ã–ª–æ:   –°–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–∏ –æ—Ç–∫–ª–∏–∫–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É
–°—Ç–∞–Ω–µ—Ç: –ö–ª–∏–µ–Ω—Ç —Å—Ä–∞–∑—É —Å–≤—è–∑—ã–≤–∞–µ—Ç—Å—è —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–º

–í–µ—Ä–¥–∏–∫—Ç: ‚úÖ –û–ö–ï–ô - –±—ã—Å—Ç—Ä–µ–µ –∏ –ø—Ä–æ—â–µ –¥–ª—è –æ–±–µ–∏—Ö —Å—Ç–æ—Ä–æ–Ω
```

---

## üöÄ –ü–õ–ê–ù –ú–ò–ì–†–ê–¶–ò–ò

### –§–∞–∑–∞ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ë–î (1 –¥–µ–Ω—å)
```sql
-- 1. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è –≤ offers
ALTER TABLE offers ADD COLUMN telegram_contact VARCHAR(100);
ALTER TABLE offers ADD COLUMN landlord_telegram_id BIGINT;

-- 2. –°–æ–∑–¥–∞—Ç—å user_map_sessions
CREATE TABLE user_map_sessions (...);

-- 3. –°–æ–∑–¥–∞—Ç—å geo-–∏–Ω–¥–µ–∫—Å
CREATE INDEX idx_properties_location ON properties 
USING GIST (ll_to_earth(latitude, longitude));

-- 4. –ó–∞–ø–æ–ª–Ω–∏—Ç—å telegram –∫–æ–Ω—Ç–∞–∫—Ç—ã –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
UPDATE offers o
SET telegram_contact = l.telegram_username,
    landlord_telegram_id = l.telegram_id
FROM landlords l
WHERE o.landlord_id = l.id;
```

### –§–∞–∑–∞ 2: API (2-3 –¥–Ω—è)
```
1. –°–æ–∑–¥–∞—Ç—å POST /api/map/session
2. –°–æ–∑–¥–∞—Ç—å GET /api/map/properties (—Å geo-–ø–æ–∏—Å–∫–æ–º)
3. –°–æ–∑–¥–∞—Ç—å POST /api/map/recenter
4. –°–æ–∑–¥–∞—Ç—å GET /api/properties/:id/contact
5. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ—Å—Ç—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã (–±—é–¥–∂–µ—Ç, —Ç–∏–ø, —É–¥–æ–±—Å—Ç–≤–∞)
```

### –§–∞–∑–∞ 3: Frontend (2-3 –¥–Ω—è)
```
1. –û–±–Ω–æ–≤–∏—Ç—å Map.tsx:
   - –î–æ–±–∞–≤–∏—Ç—å centerPoint state
   - –î–æ–±–∞–≤–∏—Ç—å handleMapClick
   - –ü–æ–∫–∞–∑–∞—Ç—å –æ–∫—Ä—É–∂–Ω–æ—Å—Ç—å —Ä–∞–¥–∏—É—Å–∞
   - –û–±–Ω–æ–≤–∏—Ç—å loadProperties (–ø–æ —Ä–∞–¥–∏—É—Å—É)

2. –û–±–Ω–æ–≤–∏—Ç—å PropertyDrawer:
   - –ü–æ–∫–∞–∑–∞—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç Telegram
   - –ö–Ω–æ–ø–∫–∞ "–°–≤—è–∑–∞—Ç—å—Å—è –≤ Telegram"

3. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ—Å—Ç—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã:
   - –°–ª–∞–π–¥–µ—Ä –±—é–¥–∂–µ—Ç–∞
   - –ß–µ–∫–±–æ–∫—Å—ã —Ç–∏–ø–æ–≤ –∂–∏–ª—å—è
   - –ß–µ–∫–±–æ–∫—Å—ã —É–¥–æ–±—Å—Ç–≤
```

### –§–∞–∑–∞ 4: Telegram Bot (1-2 –¥–Ω—è)
```
1. –û–±–Ω–æ–≤–∏—Ç—å –¥–∏–∞–ª–æ–≥ –±–æ—Ç–∞:
   - –°–ø—Ä–∞—à–∏–≤–∞—Ç—å –ª–æ–∫–∞—Ü–∏—é —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –°–æ–∑–¥–∞–≤–∞—Ç—å map session —Å —ç—Ç–æ–π –ª–æ–∫–∞—Ü–∏–µ–π
   - –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é –∫–∞—Ä—Ç—É

2. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã:
   - /map - –æ—Ç–∫—Ä—ã—Ç—å –∫–∞—Ä—Ç—É
   - /change_location - –∏–∑–º–µ–Ω–∏—Ç—å —Ü–µ–Ω—Ç—Ä –∫–∞—Ä—Ç—ã
```

### –§–∞–∑–∞ 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (1-2 –¥–Ω—è)
```
1. –¢–µ—Å—Ç geo-query (–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞–¥–∏—É—Å–∞)
2. –¢–µ—Å—Ç –∫–ª–∏–∫–∞ –Ω–∞ –∫–∞—Ä—Ç–µ (–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤)
3. –¢–µ—Å—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤
4. –¢–µ—Å—Ç –º–æ–±–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏
5. –¢–µ—Å—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Telegram
```

**–û–±—â–µ–µ –≤—Ä–µ–º—è: 7-12 –¥–Ω–µ–π** (–≤–º–µ—Å—Ç–æ 4 –Ω–µ–¥–µ–ª—å)

---

## üí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### ‚úÖ –î–ï–õ–ê–¢–¨:
1. **–ù–∞—á–∞—Ç—å —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏:**
   - –¢–æ–ª—å–∫–æ geo-radius –ø–æ–∏—Å–∫
   - –¢–æ–ª—å–∫–æ 2-3 –ø—Ä–æ—Å—Ç—ã—Ö —Ñ–∏–ª—å—Ç—Ä–∞
   - –ë–µ–∑ —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏

2. **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç–∞—Ä—ã–µ —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ –≤—Ä–µ–º—è:**
   - –ù–µ —É–¥–∞–ª—è—Ç—å rental_tasks —Å—Ä–∞–∑—É
   - –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ
   - –ò–º–µ—Ç—å fallback –Ω–∞ —Å—Ç–∞—Ä—É—é —Å–∏—Å—Ç–µ–º—É

3. **–î–æ–±–∞–≤–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É:**
   - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∏–∫–∏ –Ω–∞ –∫–∞—Ä—Ç–µ
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å, –∫—É–¥–∞ –∫–ª–∏–µ–Ω—Ç—ã —Å–º–æ—Ç—Ä—è—Ç
   - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö

### ‚ùå –ù–ï –î–ï–õ–ê–¢–¨:
1. **–ù–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏:**
   - –ú–∞–∫—Å–∏–º—É–º 5 —Ñ–∏–ª—å—Ç—Ä–æ–≤
   - –û—Å—Ç–∞–ª—å–Ω–æ–µ - –≤–∏–∑—É–∞–ª—å–Ω–æ –Ω–∞ –∫–∞—Ä—Ç–µ

2. **–ù–µ –¥–µ–ª–∞—Ç—å —Å–ª–æ–∂–Ω—ã–π UI:**
   - –ö–∞—Ä—Ç–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≥–ª–∞–≤–Ω–æ–π
   - –§–∏–ª—å—Ç—Ä—ã - –≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã

3. **–ù–µ –¥–µ–ª–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –¥–∞—Ç:**
   - –≠—Ç–æ –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ —Ä–∞–º–∫–∏ —Å–∏—Å—Ç–µ–º—ã
   - –ö–ª–∏–µ–Ω—Ç –¥–æ–≥–æ–≤–∞—Ä–∏–≤–∞–µ—Ç—Å—è —Å–∞–º

---

## üéØ –í–´–í–û–î

**–î–ê, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –Ω—É–∂–Ω–æ —É–ø—Ä–æ—â–∞—Ç—å!**

–ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥:
- ‚úÖ –í 3x –±—ã—Å—Ç—Ä–µ–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å
- ‚úÖ –í 10x –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–µ–µ
- ‚úÖ –ù–∞–º–Ω–æ–≥–æ –ø—Ä–æ—â–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å
- ‚úÖ –õ—É—á—à–µ UX (–æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º)
- ‚úÖ –õ–µ–≥—á–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å

**–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ –ù–û:** –Ω—É–∂–Ω–æ –æ–±—Å—É–¥–∏—Ç—å —Å –∑–∞–∫–∞–∑—á–∏–∫–æ–º, —É—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ:
1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ matching
2. –ü—Ä–æ–≤–µ—Ä–∫–∏ availability –ø–æ –¥–∞—Ç–∞–º
3. –°–∏—Å—Ç–µ–º—ã –æ—Ç–∫–ª–∏–∫–æ–≤

–ï—Å–ª–∏ –æ—Ç–≤–µ—Ç "–¥–∞, —É—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç" ‚Üí **–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –Ω–æ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É!**

---

## üìû –°–õ–ï–î–£–Æ–©–ò–ô –®–ê–ì

**–ü—Ä–µ–¥–ª–∞–≥–∞—é:**
1. –û–±—Å—É–¥–∏—Ç—å —ç—Ç–æ —Å –∑–∞–∫–∞–∑—á–∏–∫–æ–º
2. –ü–æ–ª—É—á–∏—Ç—å –æ–¥–æ–±—Ä–µ–Ω–∏–µ
3. –ù–∞—á–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é —Å –§–∞–∑—ã 1 (–ë–î)

**–í–æ–ø—Ä–æ—Å:** –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ —É–ø—Ä–æ—â—ë–Ω–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É?
