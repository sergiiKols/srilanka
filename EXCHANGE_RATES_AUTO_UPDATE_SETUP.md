# üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

**–î–∞—Ç–∞:** 31 —è–Ω–≤–∞—Ä—è 2026  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é

---

## üìã –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

–ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –∏–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏.

### ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** - –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é —á–µ—Ä–µ–∑ Cron
2. **–†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** - –∫–Ω–æ–ø–∫–∞ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
3. **–ì–∏–±–∫–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –∏ —á–∞—Å—Ç–æ—Ç—ã
4. **–í–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ** - –æ–¥–Ω–∏–º –∫–ª–∏–∫–æ–º
5. **–ò—Å—Ç–æ—Ä–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π** - –ª–æ–≥–∏ –≤—Å–µ—Ö –∑–∞–ø—É—Å–∫–æ–≤
6. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—É—Å–∫–æ–≤, –æ—à–∏–±–æ–∫, —É—Å–ø–µ—à–Ω–æ—Å—Ç—å

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                  ADMIN PANEL                        ‚îÇ
‚îÇ  /admin/cron-jobs ‚Üí ExchangeRatesManager.tsx        ‚îÇ
‚îÇ  - –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–∫—É—â–∏—Ö –∫—É—Ä—Å–æ–≤                          ‚îÇ
‚îÇ  - –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (–∫–Ω–æ–ø–∫–∞)                       ‚îÇ
‚îÇ  - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è                             ‚îÇ
‚îÇ  - –í–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ                             ‚îÇ
‚îÇ  - –ò—Å—Ç–æ—Ä–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
                  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ             SUPABASE DATABASE                        ‚îÇ
‚îÇ  - cron_jobs (–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–¥–∞—á)                      ‚îÇ
‚îÇ  - cron_job_logs (–ª–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è)                  ‚îÇ
‚îÇ  - exchange_rates_log (–∏—Å—Ç–æ—Ä–∏—è –∫—É—Ä—Å–æ–≤)              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
                  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ          SUPABASE EDGE FUNCTION                      ‚îÇ
‚îÇ  /functions/v1/update-exchange-rates                ‚îÇ
‚îÇ  1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫—É—Ä—Å—ã —Å API                           ‚îÇ
‚îÇ  2. –û–±–Ω–æ–≤–ª—è–µ—Ç SQL —Ñ—É–Ω–∫—Ü–∏—é                           ‚îÇ
‚îÇ  3. –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏                        ‚îÇ
‚îÇ  4. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ª–æ–≥                                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
                  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           EXTERNAL API                               ‚îÇ
‚îÇ  https://open.er-api.com/v6/latest/USD              ‚îÇ
‚îÇ  - –ë–µ—Å–ø–ª–∞—Ç–Ω–æ (1500 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–µ—Å—è—Ü)                 ‚îÇ
‚îÇ  - –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ                            ‚îÇ
‚îÇ  - –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å 99.9%                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üì¶ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### 1. Edge Function
**–§–∞–π–ª:** `supabase/functions/update-exchange-rates/index.ts`

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫—É—Ä—Å—ã —Å https://open.er-api.com/v6/latest/USD
- –û–±–Ω–æ–≤–ª—è–µ—Ç SQL —Ñ—É–Ω–∫—Ü–∏—é `calculate_price_usd()` —Å –Ω–æ–≤—ã–º–∏ –∫—É—Ä—Å–∞–º–∏
- –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç `price_usd` –¥–ª—è –≤—Å–µ—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ª–æ–≥ –≤ `exchange_rates_log`

**–ö–∞–∫ –≤—ã–∑–≤–∞—Ç—å:**
```bash
# –ß–µ—Ä–µ–∑ curl
curl -X POST https://your-project.supabase.co/functions/v1/update-exchange-rates \
  -H "Authorization: Bearer YOUR_ANON_KEY"

# –ò–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
–ö–Ω–æ–ø–∫–∞ "üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–µ–π—á–∞—Å"
```

### 2. SQL –ú–∏–≥—Ä–∞—Ü–∏—è
**–§–∞–π–ª:** `database/11_create_cron_jobs_system.sql`

**–ß—Ç–æ —Å–æ–∑–¥–∞–µ—Ç:**
- –¢–∞–±–ª–∏—Ü–∞ `cron_jobs` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á
- –¢–∞–±–ª–∏—Ü–∞ `cron_job_logs` - –ª–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –¢–∞–±–ª–∏—Ü–∞ `exchange_rates_log` - –∏—Å—Ç–æ—Ä–∏—è –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç
- View `cron_jobs_status` - —É–¥–æ–±–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞
- –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏
- –¢—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ `next_run_at`

**–ö–∞–∫ –≤—ã–ø–æ–ª–Ω–∏—Ç—å:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ Supabase SQL Editor
2. –í—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞
3. –ù–∞–∂–º–∏—Ç–µ "Run"

### 3. React –ö–æ–º–ø–æ–Ω–µ–Ω—Ç
**–§–∞–π–ª:** `src/components/admin/ExchangeRatesManager.tsx`

**–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å:**
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–∫—É—â–∏—Ö –∫—É—Ä—Å–æ–≤ (8 –≤–∞–ª—é—Ç)
- –°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–≤–∫–ª—é—á–µ–Ω–æ/–æ—Ç–∫–ª—é—á–µ–Ω–æ)
- –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Å —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä "–ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00 —É—Ç—Ä–∞")
- –ö–Ω–æ–ø–∫–∞ —Ä—É—á–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è (cron –≤—ã—Ä–∞–∂–µ–Ω–∏–µ)
- –ò—Å—Ç–æ—Ä–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 10 –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω –≤ `/admin/cron-jobs`
- –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω –ø–æ–¥ Keep-Alive —Å–∏—Å—Ç–µ–º–æ–π

---

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é

### –®–∞–≥ 1: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ Edge Function

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Supabase CLI (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
npm install -g supabase

# –í–æ–π–¥–∏—Ç–µ –≤ Supabase
supabase login

# –°–≤—è–∂–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç
supabase link --project-ref YOUR_PROJECT_REF

# –†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é
supabase functions deploy update-exchange-rates
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ (–≤—Ä—É—á–Ω—É—é):**
1. –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard ‚Üí Functions
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é `update-exchange-rates`
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥ –∏–∑ `supabase/functions/update-exchange-rates/index.ts`
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏ —Ä–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ

### –®–∞–≥ 2: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ SQL –º–∏–≥—Ä–∞—Ü–∏–∏

1. –û—Ç–∫—Ä–æ–π—Ç–µ Supabase SQL Editor
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `database/11_create_cron_jobs_system.sql`
3. –í—Å—Ç–∞–≤—å—Ç–µ –∏ –Ω–∞–∂–º–∏—Ç–µ "Run"
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã:
   ```sql
   SELECT * FROM cron_jobs WHERE name = 'update_exchange_rates';
   ```

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Supabase Cron (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π** –∑–∞–ø—É—Å–∫ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é:

```sql
-- –í–∫–ª—é—á–∏—Ç–µ pg_cron —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ (–µ—Å–ª–∏ –µ—â–µ –Ω–µ –≤–∫–ª—é—á–µ–Ω–æ)
CREATE EXTENSION IF NOT EXISTS pg_cron;

-- –°–æ–∑–¥–∞–π—Ç–µ cron –∑–∞–¥–∞—á—É
SELECT cron.schedule(
  'update_exchange_rates_daily',
  '0 3 * * *',  -- –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00 —É—Ç—Ä–∞
  $$
  SELECT net.http_post(
    url := 'https://YOUR_PROJECT.supabase.co/functions/v1/update-exchange-rates',
    headers := '{"Authorization": "Bearer YOUR_SERVICE_ROLE_KEY"}'::jsonb
  );
  $$
);
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ï—Å–ª–∏ pg_cron –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–Ω–µ—à–Ω–∏–π cron (Vercel Cron, GitHub Actions –∏ —Ç.–¥.)

### –®–∞–≥ 4: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

```bash
# –ö–æ–º–º–∏—Ç –∏ push
git add .
git commit -m "feat: automatic exchange rates update system"
git push origin main

# Vercel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç
```

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

1. –û—Ç–∫—Ä–æ–π—Ç–µ `/admin/cron-jobs` –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤–Ω–∏–∑ –¥–æ —Ä–∞–∑–¥–µ–ª–∞ "–ö—É—Ä—Å—ã –≤–∞–ª—é—Ç"
3. –ù–∞–∂–º–∏—Ç–µ "üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–µ–π—á–∞—Å"
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∫—É—Ä—Å—ã –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å
5. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è

### –§–æ—Ä–º–∞—Ç Cron

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –º–∏–Ω—É—Ç–∞ (0 - 59)
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ —á–∞—Å (0 - 23)
‚îÇ ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –¥–µ–Ω—å –º–µ—Å—è—Ü–∞ (1 - 31)
‚îÇ ‚îÇ ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –º–µ—Å—è—Ü (1 - 12)
‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏ (0 - 7, 0 –∏ 7 = –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ)
‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îÇ
* * * * *
```

### –ü—Ä–∏–º–µ—Ä—ã —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π

| –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|----------|
| `0 3 * * *` | –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00 —É—Ç—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) |
| `0 */6 * * *` | –ö–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤ |
| `0 0 * * 0` | –ö–∞–∂–¥–æ–µ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ –≤ –ø–æ–ª–Ω–æ—á—å |
| `0 0 1 * *` | –ü–µ—Ä–≤–æ–µ —á–∏—Å–ª–æ –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—è—Ü–∞ |
| `*/30 * * * *` | –ö–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç |
| `0 9,18 * * *` | –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 9:00 –∏ 18:00 |

### –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ

**–ß–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ `/admin/cron-jobs`
2. –í –±–ª–æ–∫–µ "–ö—É—Ä—Å—ã –≤–∞–ª—é—Ç" –Ω–∞–∂–º–∏—Ç–µ "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å"
3. –í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ cron –≤—ã—Ä–∞–∂–µ–Ω–∏–µ
4. –ù–∞–∂–º–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"

**–ß–µ—Ä–µ–∑ SQL:**
```sql
UPDATE cron_jobs 
SET schedule = '0 */6 * * *'  -- –ö–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤
WHERE name = 'update_exchange_rates';
```

---

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

### –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

–ö–Ω–æ–ø–∫–∞ **"üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–µ–π—á–∞—Å"** - –∑–∞–ø—É—Å–∫–∞–µ—Ç Edge Function –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ.

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞ Edge Function
- –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
- –ï—Å–ª–∏ –Ω—É–∂–Ω—ã —Å–≤–µ–∂–∏–µ –∫—É—Ä—Å—ã –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å

### –í–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ

–ö–Ω–æ–ø–∫–∞ **"–û—Ç–∫–ª—é—á–∏—Ç—å" / "–í–∫–ª—é—á–∏—Ç—å"** - —É–ø—Ä–∞–≤–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º.

**–ö–æ–≥–¥–∞ –æ—Ç–∫–ª—é—á–∞—Ç—å:**
- –í–æ –≤—Ä–µ–º—è –æ—Ç–ª–∞–¥–∫–∏
- –ï—Å–ª–∏ API –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —Ä—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

### –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏

–ë–ª–æ–∫ **"–ò—Å—Ç–æ—Ä–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π"** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –∑–∞–ø—É—Å–∫–æ–≤:
- ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- ‚ùå –û—à–∏–±–∫–∏ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º
- –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –≤–∞–ª—é—Ç

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏

```sql
SELECT * FROM cron_jobs_status 
WHERE name = 'update_exchange_rates';
```

–ü–æ–∫–∞–∂–µ—Ç:
- –í–∫–ª—é—á–µ–Ω–∞ –ª–∏ –∑–∞–¥–∞—á–∞
- –ö–æ–≥–¥–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑ –∑–∞–ø—É—Å–∫–∞–ª–∞—Å—å
- –ö–æ–≥–¥–∞ —Å–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—É—Å–∫
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```sql
-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ 20 –∑–∞–ø—É—Å–∫–æ–≤
SELECT 
  started_at,
  status,
  message,
  duration_ms
FROM cron_job_logs 
WHERE job_id = (SELECT id FROM cron_jobs WHERE name = 'update_exchange_rates')
ORDER BY started_at DESC
LIMIT 20;
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –∫—É—Ä—Å–æ–≤

```sql
-- –¢–µ–∫—É—â–∏–µ –∫—É—Ä—Å—ã
SELECT * FROM exchange_rates_log 
WHERE success = true
ORDER BY created_at DESC
LIMIT 1;

-- –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫—É—Ä—Å–∞ LKR
SELECT 
  created_at,
  rates->>'LKR' as lkr_rate
FROM exchange_rates_log
WHERE success = true
ORDER BY created_at DESC
LIMIT 30;
```

### –û—Ç–ª–∞–¥–∫–∞ –æ—à–∏–±–æ–∫

–ï—Å–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Edge Function:**
   ```bash
   supabase functions logs update-exchange-rates
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API:**
   ```bash
   curl https://open.er-api.com/v6/latest/USD
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:**
   ```sql
   SELECT * FROM pg_policies 
   WHERE tablename IN ('cron_jobs', 'exchange_rates_log');
   ```

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –æ—à–∏–±–æ–∫:**
   ```sql
   SELECT * FROM exchange_rates_log 
   WHERE success = false
   ORDER BY created_at DESC;
   ```

---

## üéØ –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### Q: –ö–∞–∫ —á–∞—Å—Ç–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –∫—É—Ä—Å—ã?

**A:** –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è **—Ä–∞–∑ –≤ –¥–µ–Ω—å –≤ 3:00 —É—Ç—Ä–∞** (`0 3 * * *`). –ö—É—Ä—Å—ã –Ω–∞ API –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Ä–∞–∑ –≤ 24 —á–∞—Å–∞, –ø–æ—ç—Ç–æ–º—É —á–∞—â–µ –Ω–µ—Ç —Å–º—ã—Å–ª–∞.

### Q: –ß—Ç–æ –µ—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω?

**A:** –°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ fallback –∫—É—Ä—Å—ã** –∏–∑ `src/utils/currencyConverter.ts`. –û–±—ä–µ–∫—Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∞—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏ –∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ –∫—É—Ä—Å–∞–º–∏.

### Q: –ù—É–∂–Ω–æ –ª–∏ –≤—Ä—É—á–Ω—É—é –æ–±–Ω–æ–≤–ª—è—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –∫—É—Ä—Å—ã?

**A:** –ù–µ—Ç, –µ—Å–ª–∏ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ. –ù–æ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–ª—è—Ç—å –∏—Ö —Ä–∞–∑ –≤ –º–µ—Å—è—Ü.

### Q: –°–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç API?

**A:** **–ë–µ—Å–ø–ª–∞—Ç–Ω–æ** –¥–æ 1500 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–µ—Å—è—Ü. –ü—Ä–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–∏ "—Ä–∞–∑ –≤ –¥–µ–Ω—å" —ç—Ç–æ 30 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–µ—Å—è—Ü.

### Q: –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ API?

**A:** –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `supabase/functions/update-exchange-rates/index.ts`, —Å—Ç—Ä–æ–∫–∞ 56:
```typescript
const apiResponse = await fetch('https://open.er-api.com/v6/latest/USD');
```

–ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –¥—Ä—É–≥–æ–π API (–Ω–∞–ø—Ä–∏–º–µ—Ä `exchangerate-api.com`, `fixer.io` –∏ —Ç.–¥.)

### Q: –ú–æ–∂–Ω–æ –ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –≤–∞–ª—é—Ç?

**A:** –î–∞! –û–±–Ω–æ–≤–∏—Ç–µ `SUPPORTED_CURRENCIES` –≤ Edge Function:
```typescript
const SUPPORTED_CURRENCIES = ['LKR', 'EUR', 'GBP', 'INR', 'RUB', 'AUD', 'CAD', 'THB', 'JPY'];
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

- [ ] Edge Function —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞ –≤ Supabase
- [ ] SQL –º–∏–≥—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
- [ ] –¢–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã (`cron_jobs`, `cron_job_logs`, `exchange_rates_log`)
- [ ] –ó–∞–¥–∞—á–∞ `update_exchange_rates` —Å–æ–∑–¥–∞–Ω–∞ –∏ –≤–∫–ª—é—á–µ–Ω–∞
- [ ] –§—Ä–æ–Ω—Ç–µ–Ω–¥ –∑–∞–¥–µ–ø–ª–æ–µ–Ω –Ω–∞ Vercel
- [ ] –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å `/admin/cron-jobs` –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
- [ ] –ö–æ–º–ø–æ–Ω–µ–Ω—Ç "–ö—É—Ä—Å—ã –≤–∞–ª—é—Ç" –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- [ ] –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ö—É—Ä—Å—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –ò—Å—Ç–æ—Ä–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –í–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Supabase Cron –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üìÑ –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- **Edge Function:** `supabase/functions/update-exchange-rates/index.ts`
- **SQL –ú–∏–≥—Ä–∞—Ü–∏—è:** `database/11_create_cron_jobs_system.sql`
- **React –ö–æ–º–ø–æ–Ω–µ–Ω—Ç:** `src/components/admin/ExchangeRatesManager.tsx`
- **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å:** `src/pages/admin/cron-jobs.astro`
- **–ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä:** `src/utils/currencyConverter.ts`
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** `CURRENCY_CONVERSION_IMPLEMENTATION.md`

---

**–ê–≤—Ç–æ—Ä:** Rovo Dev  
**–î–∞—Ç–∞:** 2026-01-31  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é
