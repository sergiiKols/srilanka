# üìã –ò–¢–û–ì–ò –°–ï–°–°–ò–ò 2026-01-28: Telegram Bot Web App

**–î–∞—Ç–∞:** 2026-01-28 22:30 UTC  
**–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** ~4 —á–∞—Å–∞  
**–ò—Ç–µ—Ä–∞—Ü–∏–π:** 70+  
**–°—Ç–∞—Ç—É—Å:** ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ –ù–ï —Ä–µ—à–µ–Ω–∞

---

## üéØ –ó–ê–î–ê–ß–ê

–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Telegram –±–æ—Ç–∞ @AiTechLab_bot –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è Web App —Ñ–æ—Ä–º—ã –∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä–æ–≤ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É Menu Button.

**Bot Token:** `7958965950:AAFg63FTJ46hcRT6M2wSBzn9RHCrzvfV3q8`  
**Admin Chat ID:** `1000089271`  
**Production URL:** `https://srilanka-37u2.vercel.app`

---

## ‚úÖ –ß–¢–û –†–ê–ë–û–¢–ê–ï–¢

1. ‚úÖ Bot Token –¥–æ–±–∞–≤–ª–µ–Ω –≤ `.env`
2. ‚úÖ Admin Chat ID –Ω–∞—Å—Ç—Ä–æ–µ–Ω
3. ‚úÖ Deployment Protection –æ—Ç–∫–ª—é—á–µ–Ω–∞
4. ‚úÖ Environment Variables –¥–æ–±–∞–≤–ª–µ–Ω—ã –Ω–∞ Vercel
5. ‚úÖ Menu Button –Ω–∞—Å—Ç—Ä–æ–µ–Ω —á–µ—Ä–µ–∑ API
6. ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü—ã `/` –∏ `/map` —Ä–∞–±–æ—Ç–∞—é—Ç (200 OK)
7. ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ `/tenant-app` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –æ—Ç–¥–∞—ë—Ç 200 OK
8. ‚úÖ Build Cache –æ—Ç–∫–ª—é—á—ë–Ω –≤ Vercel

---

## ‚ùå –ü–†–û–ë–õ–ï–ú–ê

**–ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ Web App —á–µ—Ä–µ–∑ –±–æ—Ç–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è:**

```
‚ö†Ô∏è Error
This page must be opened from Telegram.
Please use the Telegram bot to access this form.
```

**–ü—Ä–∏—á–∏–Ω–∞:** –°—Ç—Ä–∞–Ω–∏—Ü–∞ `/tenant-app` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ `window.Telegram.WebApp` –∏ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –Ω–µ –∏–∑ Telegram.

---

## üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê

### –†–∞–±–æ—Ç–∞—é—â–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:
- ‚úÖ `/` ‚Üí 200 OK
- ‚úÖ `/map` ‚Üí 200 OK  
- ‚úÖ `/tenant-app` ‚Üí 200 OK (–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É)

### –ù–µ —Ä–∞–±–æ—Ç–∞—é—â–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (404):
- ‚ùå `/webapp`
- ‚ùå `/tenant-form`
- ‚ùå `/test-form`

### Vercel Deployments:
- –ü–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–±–æ—á–∏–π: `bdaa830` (v5.0) - ‚úÖ Ready
- –í—Å–µ –¥–µ–ø–ª–æ–∏ –ø–æ—Å–ª–µ –Ω–µ–≥–æ: ‚ùå Error (–ø–∞–¥–∞—é—Ç –∑–∞ 9-23 —Å–µ–∫—É–Ω–¥—ã)

---

## üìù –ß–¢–û –ü–û–ü–†–û–ë–û–í–ê–õ–ò (15+ –ø–æ–ø—ã—Ç–æ–∫)

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞ ‚úÖ
- –î–æ–±–∞–≤–ª–µ–Ω —Ç–æ–∫–µ–Ω –≤ `.env`
- –ù–∞—Å—Ç—Ä–æ–µ–Ω Menu Button —á–µ—Ä–µ–∑ @BotFather
- –û–±–Ω–æ–≤–ª—ë–Ω URL —á–µ—Ä–µ–∑ Telegram Bot API

### 2. Vercel –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ‚úÖ
- –û—Ç–∫–ª—é—á–µ–Ω–∞ Deployment Protection
- –î–æ–±–∞–≤–ª–µ–Ω—ã Environment Variables
- –û—Ç–∫–ª—é—á—ë–Ω Build Cache
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω Production URL

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü ‚ùå
- `test-form.astro` ‚Üí 404
- `tenant-form.astro` ‚Üí 404
- `webapp.astro` ‚Üí 404
- `public/webapp/index.html` ‚Üí 404

### 4. –ò–∑–º–µ–Ω–µ–Ω–∏–µ Astro –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ ‚ùå
- `output: 'static'` ‚Üí Error
- `output: 'hybrid'` ‚Üí Error
- `export const prerender = true` ‚Üí Error

### 5. Telegram SDK ‚úÖ
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `@twa-dev/sdk`
- –°–æ–∑–¥–∞–Ω –ª–æ–∫–∞–ª—å–Ω—ã–π polyfill
- –ü—Ä–æ–≤–µ—Ä–µ–Ω –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π SDK

---

## üéØ –ö–û–†–ù–ï–í–ê–Ø –ü–†–ò–ß–ò–ù–ê

**–°—Ç—Ä–∞–Ω–∏—Ü–∞ `/tenant-app` –†–ê–ë–û–¢–ê–ï–¢, –Ω–æ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–æ–≤–µ—Ä–∫—É:**

```javascript
if (window.Telegram && window.Telegram.WebApp) {
  // –ü–æ–∫–∞–∑–∞—Ç—å —Ñ–æ—Ä–º—É
} else {
  // –ü–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É "must be opened from Telegram"
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:** Telegram SDK –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–ª–∏ WebApp –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è.

---

## üí° –í–û–ó–ú–û–ñ–ù–´–ï –†–ï–®–ï–ù–ò–Ø

### –í–∞—Ä–∏–∞–Ω—Ç 1: –£–±—Ä–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É Telegram
–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å `src/pages/tenant-app.astro` –∏ —É–±—Ä–∞—Ç—å —É—Å–ª–æ–≤–∏–µ:

```javascript
// –ë—ã–ª–æ:
if (window.Telegram && window.Telegram.WebApp) {
  // –ø–æ–∫–∞–∑–∞—Ç—å —Ñ–æ—Ä–º—É
} else {
  // –ø–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É
}

// –°—Ç–∞–ª–æ:
// –ü–æ–∫–∞–∑–∞—Ç—å —Ñ–æ—Ä–º—É –≤—Å–µ–≥–¥–∞
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Telegram SDK –∑–∞–≥—Ä—É–∑–∫—É
–î–æ–±–∞–≤–∏—Ç—å debug –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:

```javascript
console.log('Telegram:', window.Telegram);
console.log('WebApp:', window.Telegram?.WebApp);
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π URL
Telegram –º–æ–∂–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å:
- –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä –≤–µ—Ä—Å–∏–∏: `/tenant-app?v=2`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π path: `/form` –≤–º–µ—Å—Ç–æ `/tenant-app`

---

## üìÇ –í–ê–ñ–ù–´–ï –§–ê–ô–õ–´

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
- `astro.config.mjs` - Astro –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (—Å–µ–π—á–∞—Å `output: 'server'`)
- `.env` - Environment Variables (–ª–æ–∫–∞–ª—å–Ω–æ)
- `vercel.json` - Vercel –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è (—Å–æ–∑–¥–∞–Ω)

### –°—Ç—Ä–∞–Ω–∏—Ü—ã:
- `src/pages/tenant-app.astro` - –§–æ—Ä–º–∞ –∞—Ä–µ–Ω–¥–∞—Ç–æ—Ä–æ–≤ ‚úÖ (—Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π)
- `src/pages/tenant-form.astro` - –ö–æ–ø–∏—è (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- `src/pages/webapp.astro` - –¢–µ—Å—Ç–æ–≤–∞—è (404)
- `public/webapp/index.html` - –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è (404)

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- `src/components/TenantRequestForm.tsx` - React —Ñ–æ—Ä–º–∞ (650+ —Å—Ç—Ä–æ–∫)
- `src/lib/telegram.ts` - Telegram —É—Ç–∏–ª–∏—Ç—ã

### –û—Ç—á—ë—Ç—ã (—Å–æ–∑–¥–∞–Ω—ã —Å–µ–≥–æ–¥–Ω—è):
- `TROUBLESHOOTING_REPORT.md` - –ü–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç –ø–æ–ø—ã—Ç–æ–∫
- `FINAL_ANALYSIS.md` - –§–∏–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑
- `TELEGRAM_BOT_PROBLEM.md` - –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
- `SESSION_SUMMARY_2026-01-28.md` - –≠—Ç–æ—Ç —Ñ–∞–π–ª

---

## üîß –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò (–¥–ª—è –∑–∞–≤—Ç—Ä–∞)

### –®–ê–ì 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Telegram SDK –≤ Dev Tools
–û—Ç–∫—Ä—ã—Ç—å `/tenant-app` –≤ Chrome Dev Tools:
1. –û—Ç–∫—Ä—ã—Ç—å Console
2. –í–≤–µ—Å—Ç–∏: `window.Telegram`
3. –í–≤–µ—Å—Ç–∏: `window.Telegram.WebApp`
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è

### –®–ê–ì 2: –£–±—Ä–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É Telegram (–≤—Ä–µ–º–µ–Ω–Ω–æ)
```bash
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å src/pages/tenant-app.astro
# –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –±–ª–æ–∫ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π
# –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ñ–æ—Ä–º—É –≤—Å–µ–≥–¥–∞
```

### –®–ê–ì 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ –±–æ—Ç–∞
–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:
1. –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏ –∑–∞–ø—É—à–∏—Ç—å
2. –ü–æ–¥–æ–∂–¥–∞—Ç—å –¥–µ–ø–ª–æ–π
3. –ó–∞–∫—Ä—ã—Ç—å Telegram –ø–æ–ª–Ω–æ—Å—Ç—å—é
4. –û—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞ –∏ –Ω–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É

### –®–ê–ì 4: –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–∂–µ—Ç - –¥—Ä—É–≥–æ–π —Ö–æ—Å—Ç–∏–Ω–≥
–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å:
- Netlify
- Cloudflare Pages
- –ü—Ä–æ—Å—Ç–æ–π Node.js —Å–µ—Ä–≤–µ—Ä

---

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê

- **–ö–æ–º–º–∏—Ç–æ–≤:** 15+
- **–î–µ–ø–ª–æ–µ–≤:** 20+
- **–£—Å–ø–µ—à–Ω—ã—Ö:** 10
- **–° –æ—à–∏–±–∫–æ–π:** 10
- **–ò–∑–º–µ–Ω—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤:** 10+
- **–°–æ–∑–¥–∞–Ω–Ω—ã—Ö –æ—Ç—á—ë—Ç–æ–≤:** 4
- **–í—Ä–µ–º–µ–Ω–∏ –ø–æ—Ç—Ä–∞—á–µ–Ω–æ:** ~4 —á–∞—Å–∞

---

## üéì –£–†–û–ö–ò

### –ß—Ç–æ —É–∑–Ω–∞–ª–∏:
1. ‚úÖ Vercel –º–æ–∂–µ—Ç –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å
2. ‚úÖ Astro SSR —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
3. ‚úÖ Telegram Web App —Ç—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
4. ‚úÖ Build Logs –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
5. ‚úÖ –ò–Ω–æ–≥–¥–∞ –ø—Ä–æ—â–µ –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è —á–µ–º —á–∏–Ω–∏—Ç—å –¥–∞–ª—å—à–µ

### –ß—Ç–æ –ù–ï —Å—Ä–∞–±–æ—Ç–∞–ª–æ:
1. ‚ùå –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü (–≤—Å–µ 404)
2. ‚ùå –ò–∑–º–µ–Ω–µ–Ω–∏–µ output mode (–≤—Å–µ Error)
3. ‚ùå Static HTML –≤ public/ (404)
4. ‚ùå Prerender —Ñ–ª–∞–≥ (Error)
5. ‚ùå –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ (404)

---

## üîó –ü–û–õ–ï–ó–ù–´–ï –°–°–´–õ–ö–ò

- Vercel Project: https://vercel.com/sergiis-projects-48df2a28/srilanka-37u2
- GitHub Repo: https://github.com/sergiiKols/srilanka
- Telegram Bot: @AiTechLab_bot
- Telegram Bot API Docs: https://core.telegram.org/bots/webapps
- Astro Docs: https://docs.astro.build

---

## üí¨ –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–°

**Menu Button –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞:** `https://srilanka-37u2.vercel.app/tenant-app`  
**–°—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ—Å—Ç—É–ø–Ω–∞:** ‚úÖ –î–∞ (200 OK)  
**–§–æ—Ä–º–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è:** ‚ùå –ù–µ—Ç (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É "must be opened from Telegram")

**–ü—Ä–æ–±–ª–µ–º–∞:** –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ `window.Telegram.WebApp` –≤ –∫–æ–¥–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.

---

## üöÄ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢ (–∑–∞–≤—Ç—Ä–∞)

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å
git status
git log --oneline -5

# 2. –û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
code src/pages/tenant-app.astro

# 3. –ù–∞–π—Ç–∏ –∏ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É:
# if (window.Telegram && window.Telegram.WebApp) { ... }

# 4. –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å
git add src/pages/tenant-app.astro
git commit -m "Remove Telegram check - show form always"
git push origin main

# 5. –ü–æ–¥–æ–∂–¥–∞—Ç—å 2 –º–∏–Ω—É—Ç—ã –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –±–æ—Ç–µ
```

---

**–°–æ–∑–¥–∞–Ω–æ:** 2026-01-28 22:30 UTC  
**–ü–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç:** `bdaa830` (–æ—Ç–∫–∞—á–µ–Ω)  
**Git branch:** `main`  
**Node version:** (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å `node -v`)  
**npm version:** (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å `npm -v`)

---

## üåô –°–ü–û–ö–û–ô–ù–û–ô –ù–û–ß–ò!

–ó–∞–≤—Ç—Ä–∞ –ø—Ä–æ–¥–æ–ª–∂–∏–º —Å –Ω–æ–≤—ã–º–∏ —Å–∏–ª–∞–º–∏! üí™

**P.S.** –û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ - –∫–æ–¥ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã. –ù—É–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ —É–±—Ä–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å debug.
