# ü§ñ Telegram API Integration

## –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Telegram –±–æ—Ç–∞–º–∏. API –ø—Ä–∏–Ω–∏–º–∞–µ—Ç webhook'–∏ –æ—Ç Telegram –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º.

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è API

### Environment Variable

```bash
# .env —Ñ–∞–π–ª
SITE_API_URL=https://–≤–∞—à-—Å–∞–π—Ç.ru/api
```

**–û–ø–∏—Å–∞–Ω–∏–µ:**
- `SITE_API_URL` - –±–∞–∑–æ–≤—ã–π URL –≤–∞—à–µ–≥–æ —Å–∞–π—Ç–∞ –¥–ª—è API endpoints
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Telegram –±–æ—Ç–∞–º–∏
- Telegram –±–æ—Ç—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç webhook'–∏ –Ω–∞ —ç—Ç–æ—Ç URL
- **–í–∞–∂–Ω–æ:** –í production —Ç—Ä–µ–±—É–µ—Ç—Å—è HTTPS

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

**–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞:**
```bash
SITE_API_URL=http://localhost:4321/api
```

**Production:**
```bash
SITE_API_URL=https://cryptonomads.ru/api
```

## API Endpoints –¥–ª—è Telegram

### 1. Telegram Forms API
**Endpoint:** `POST /api/telegram-form`

–ü—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º –æ—Ç Telegram Web App.

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:**
- –û–±—Ä–∞–±–æ—Ç–∫–∞ submissions –æ—Ç Telegram –±–æ—Ç–æ–≤
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ Supabase
- –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ Telegram —á–∞—Ç—ã

**–ü—Ä–∏–º–µ—Ä webhook URL –¥–ª—è Telegram –±–æ—Ç–∞:**
```
https://–≤–∞—à-—Å–∞–π—Ç.ru/api/telegram-form
```

### 2. –î—Ä—É–≥–∏–µ Telegram endpoints

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ endpoints –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤:
- `src/pages/api/telegram-form.ts`
- `src/pages/api/admin/forms/`

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Webhook

–î–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ webhook –≤ Telegram –±–æ—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

```bash
curl -X POST https://api.telegram.org/bot<YOUR_BOT_TOKEN>/setWebhook \
  -H "Content-Type: application/json" \
  -d '{"url": "https://–≤–∞—à-—Å–∞–π—Ç.ru/api/telegram-form"}'
```

–ì–¥–µ `https://–≤–∞—à-—Å–∞–π—Ç.ru/api/telegram-form` –±–µ—Ä—ë—Ç—Å—è –∏–∑ `SITE_API_URL + endpoint`.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

‚úÖ **Production:**
- HTTPS –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω (Telegram —Ç—Ä–µ–±—É–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ)
- –ü—É–±–ª–∏—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ã–π URL
- –í–∞–ª–∏–¥–Ω—ã–π SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç

‚úÖ **Development:**
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTTP –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º Telegram –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ ngrok –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏

## –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `.env.example` - —à–∞–±–ª–æ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `src/pages/api/telegram-form.ts` - –æ—Å–Ω–æ–≤–Ω–æ–π API endpoint
- `src/lib/telegram.ts` - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Telegram
- `TELEGRAM_FORMS_COMPLETE.md` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ñ–æ—Ä–º–∞–º
- `TELEGRAM_FORMS_INTEGRATION_COMPLETE.md` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ –∞–¥–º–∏–Ω–∫—É

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–∞–∂–Ω–æ:**
- `SITE_API_URL` –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–±–µ–∑ `PUBLIC_` –ø—Ä–µ—Ñ–∏–∫—Å–∞)
- –ù–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–¥ –±—Ä–∞—É–∑–µ—Ä–∞
- –•—Ä–∞–Ω–∏—Ç–µ `.env` –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–¥–æ–±–∞–≤–ª–µ–Ω –≤ `.gitignore`)

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `SITE_API_URL` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ `.env`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä: `npm run dev`
3. –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å Telegram –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ ngrok –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ URL

```bash
ngrok http 4321
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π HTTPS URL –∫–∞–∫ SITE_API_URL
```

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Telegram —Å–º.:
- `TELEGRAM_FORMS_COMPLETE.md`
- `PROJECT_DOCS/TELEGRAM_INTEGRATION_ANALYSIS.txt`
