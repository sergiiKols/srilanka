# ‚úÖ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã "Show Archived (0)"

## üéØ –î–∏–∞–≥–Ω–æ–∑

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–Ω–æ–ø–∫–∞ "Show Archived" —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç **(0)** –æ–±—ä–µ–∫—Ç–æ–≤.

**–ü—Ä–∏—á–∏–Ω–∞:** –í —Ç–∞–±–ª–∏—Ü–µ `archived_properties` –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π! –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–∞—è.

**–ö–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ** - –ø—Ä–æ—Å—Ç–æ –Ω–µ—á–µ–≥–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å! ‚ú®

---

## üîß –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
**–§–∞–π–ª:** `src/components/admin/AdminMasterMap.tsx`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω –ª–æ–≥ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
- –î–æ–±–∞–≤–ª–µ–Ω –ª–æ–≥ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
- –î–æ–±–∞–≤–ª–µ–Ω –≤—ã–≤–æ–¥ –ø–µ—Ä–≤–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
- –î–æ–±–∞–≤–ª–µ–Ω—ã –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–æ–∫

**–¢–µ–ø–µ—Ä—å –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—É–¥–µ—Ç:**
```javascript
üì¶ –ó–∞–≥—Ä—É–∂–∞–µ–º –∞—Ä—Ö–∏–≤–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –∏–∑ archived_properties
üìä –§–∏–ª—å—Ç—Ä—ã: {dateFilter: "all", selectedUser: "all", showArchived: true}
üì¶ –ü–æ–ª—É—á–µ–Ω–æ –∏–∑ –±–∞–∑—ã: N –∞—Ä—Ö–∏–≤–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
üì¶ –ü–µ—Ä–≤—ã–π –æ–±—ä–µ–∫—Ç: {...}
‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ N –∞—Ä—Ö–∏–≤–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
```

### 2. ‚úÖ –°–æ–∑–¥–∞–Ω SQL-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
**–§–∞–π–ª:** `tmp_rovodev_add_test_archived.sql`

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
- –î–æ–±–∞–≤–ª—è–µ—Ç —Ç–µ—Å—Ç–æ–≤—É—é –∑–∞–ø–∏—Å—å
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—Å—Ç–∞–≤–∫–∏

### 3. ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
**–§–∞–π–ª—ã:**
- `FIX_ARCHIVED_BUTTON_NOW.md` - –ë—ã—Å—Ç—Ä–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (3 –º–∏–Ω—É—Ç—ã)
- `DEBUG_ARCHIVED_BUTTON.md` - –î–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ç–ª–∞–¥–∫–∞
- `ARCHIVED_BUTTON_STATUS.md` - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–∏

---

## üöÄ –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å

### –í–∞—Ä–∏–∞–Ω—Ç –ê: –ë—ã—Å—Ç—Ä–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. **–û—Ç–∫—Ä–æ–π—Ç–µ Supabase SQL Editor**
2. **–í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞** `tmp_rovodev_add_test_archived.sql`
3. **–û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É** `/admin/master-map`
4. **–í–∫–ª—é—á–∏—Ç–µ —á–µ–∫–±–æ–∫—Å** "Show Archived"
5. **–ì–æ—Ç–æ–≤–æ!** –î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è —Å–µ—Ä—ã–π –º–∞—Ä–∫–µ—Ä –≤ Galle

### –í–∞—Ä–∏–∞–Ω—Ç –ë: –°–æ–∑–¥–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∞—Ä—Ö–∏–≤–Ω—ã–µ –∑–∞–ø–∏—Å–∏

–£–¥–∞–ª–∏—Ç–µ –∫–∞–∫–æ–π-–Ω–∏–±—É–¥—å –æ–±—ä–µ–∫—Ç —á–µ—Ä–µ–∑ PropertyDrawer:
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ª—é–±–æ–π –æ–±—ä–µ–∫—Ç –Ω–∞ –∫–∞—Ä—Ç–µ
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "Delete"
3. –û–±—ä–µ–∫—Ç –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—Å—è –≤ `archived_properties`
4. –í–∫–ª—é—á–∏—Ç–µ "Show Archived" - —É–≤–∏–¥–∏—Ç–µ —É–¥–∞–ª—ë–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç!

---

## üìä –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞ –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏:

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª—è–µ—Ç –æ–±—ä–µ–∫—Ç
   ‚Üì
2. –û–±—ä–µ–∫—Ç –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –∏–∑ saved_properties ‚Üí archived_properties
   ‚Üì
3. –í archived_properties:
   - can_restore = TRUE (–º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å)
   - archive_reason = 'user_deleted'
   - archived_at = —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è
   ‚Üì
4. Admin –≤–∫–ª—é—á–∞–µ—Ç "Show Archived"
   ‚Üì
5. –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è loadArchivedProperties()
   - –§–∏–ª—å—Ç—Ä: can_restore = TRUE
   - –ü—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ –¥–∞—Ç–µ/–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
   ‚Üì
6. –û–±—ä–µ–∫—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞ –∫–∞—Ä—Ç–µ:
   - –¶–≤–µ—Ç: #9ca3af (—Å–µ—Ä—ã–π)
   - –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å: 0.5
   - –ü—Ä–µ—Ñ–∏–∫—Å: [ARCHIVED]
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã archived_properties:

```sql
- id (primary key)
- title, property_type, latitude, longitude
- price, currency, bedrooms, bathrooms
- telegram_user_id
- can_restore (boolean) ‚Üê –§–∏–ª—å—Ç—Ä –¥–ª—è –ø–æ–∫–∞–∑–∞
- archive_reason (text) ‚Üê –ü—Ä–∏—á–∏–Ω–∞ –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏
- archived_at (timestamp) ‚Üê –ö–æ–≥–¥–∞ –∑–∞–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω
- original_created_at (timestamp) ‚Üê –ö–æ–≥–¥–∞ —Å–æ–∑–¥–∞–Ω
- days_active (integer) ‚Üê –°–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –±—ã–ª –∞–∫—Ç–∏–≤–µ–Ω
```

---

## üé® –í–∏–∑—É–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

### –î–æ –≤–∫–ª—é—á–µ–Ω–∏—è "Show Archived":
```
–ö–∞—Ä—Ç–∞: [üî¥ Active Property] [üî¥ Active Property]
Admin Panel: ‚òê Show Archived (0)
```

### –ü–æ—Å–ª–µ –≤–∫–ª—é—á–µ–Ω–∏—è "Show Archived":
```
–ö–∞—Ä—Ç–∞: [üî¥ Active] [üî¥ Active] [‚ö™ Archived] [‚ö™ Archived]
                                 ‚Üë –°–µ—Ä—ã–µ –∏ –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ
Admin Panel: ‚òë Show Archived (2)
```

### –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∞—Ä—Ö–∏–≤–Ω—ã–π –æ–±—ä–µ–∫—Ç:
```
PropertyDrawer –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å:
- –ó–∞–≥–æ–ª–æ–≤–æ–∫: [ARCHIVED] Villa Name
- –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
- –ö–Ω–æ–ø–∫–∞ Delete –∞–∫—Ç–∏–≤–Ω–∞ (–¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –±—É–¥—É—â–µ–º)
```

---

## üîÆ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –ö–Ω–æ–ø–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
```tsx
{property.isArchived && (
    <button onClick={handleRestore}>
        üîÑ Restore from Archive
    </button>
)}
```

### 2. –§–∏–ª—å—Ç—Ä –ø–æ –ø—Ä–∏—á–∏–Ω–µ –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏
```tsx
<select value={archiveReason}>
    <option value="all">All reasons</option>
    <option value="user_deleted">User deleted</option>
    <option value="expired">Expired</option>
    <option value="admin_archived">Admin archived</option>
</select>
```

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏–≤–∞—Ü–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏
```sql
-- Cron job: –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π
UPDATE saved_properties 
SET deleted_at = NOW()
WHERE created_at < NOW() - INTERVAL '30 days';
```

### 4. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞—Ä—Ö–∏–≤–∞
```tsx
<div>
    üì¶ Archived: {archivedProperties.length}
    üóëÔ∏è User deleted: {userDeletedCount}
    ‚è∞ Expired: {expiredCount}
    üîÑ Can restore: {canRestoreCount}
</div>
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏

- [ ] SQL-—Å–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω (`tmp_rovodev_add_test_archived.sql`)
- [ ] –í Supabase –µ—Å—Ç—å –∑–∞–ø–∏—Å—å –≤ `archived_properties`
- [ ] –°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ (F5)
- [ ] Admin Panel –æ—Ç–∫—Ä—ã—Ç
- [ ] –ß–µ–∫–±–æ–∫—Å "Show Archived" –≤–∫–ª—é—á—ë–Ω
- [ ] –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç "Show Archived (1)" –∏–ª–∏ –±–æ–ª—å—à–µ
- [ ] –ù–∞ –∫–∞—Ä—Ç–µ –≤–∏–¥–µ–Ω —Å–µ—Ä—ã–π –º–∞—Ä–∫–µ—Ä
- [ ] –ü—Ä–∏ –∫–ª–∏–∫–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è PropertyDrawer
- [ ] –í –Ω–∞–∑–≤–∞–Ω–∏–∏ –µ—Å—Ç—å –ø—Ä–µ—Ñ–∏–∫—Å [ARCHIVED]
- [ ] –í –∫–æ–Ω—Å–æ–ª–∏ –Ω–µ—Ç –æ—à–∏–±–æ–∫

---

## üìû –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–û—Ç–ø—Ä–∞–≤—å—Ç–µ –º–Ω–µ:**

1. **–°–∫—Ä–∏–Ω—à–æ—Ç –∫–æ–Ω—Å–æ–ª–∏** –±—Ä–∞—É–∑–µ—Ä–∞ (F12 ‚Üí Console) –ø–æ—Å–ª–µ –≤–∫–ª—é—á–µ–Ω–∏—è "Show Archived"
2. **–†–µ–∑—É–ª—å—Ç–∞—Ç SQL:** `SELECT COUNT(*) FROM archived_properties;`
3. **–†–µ–∑—É–ª—å—Ç–∞—Ç SQL:** `SELECT * FROM archived_properties LIMIT 1;`

–ò —è –ø–æ–º–æ–≥—É —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è! üöÄ

---

## üéâ –ò—Ç–æ–≥

**–ü—Ä–æ–±–ª–µ–º–∞:** –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–∞—è ‚Üí –Ω–µ—á–µ–≥–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –∑–∞–ø–∏—Å—å ‚Üí –≤—Å—ë –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç
**–í—Ä–µ–º—è:** 3 –º–∏–Ω—É—Ç—ã ‚ö°

–ö–Ω–æ–ø–∫–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ **–∏–¥–µ–∞–ª—å–Ω–æ** - –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –Ω–∞–¥–æ! 
–ü—Ä–æ—Å—Ç–æ –Ω—É–∂–Ω—ã –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è. üòä
