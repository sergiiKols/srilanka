import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as a}from"./index.JXKNaeUN.js";function u(){const[d,o]=a.useState([]),[c,x]=a.useState(!0),[r,m]=a.useState(null);a.useEffect(()=>{i(),l()},[]);const i=async()=>{try{const t=await(await fetch("/api/admin/forms")).json();t.success&&o(t.data||[])}catch(s){console.error("Load forms error:",s)}finally{x(!1)}},l=async()=>{try{const t=await(await fetch("/api/admin/stats")).json();t.success&&m(t.data)}catch(s){console.error("Load stats error:",s)}},g=async s=>{if(confirm("Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ ÑÑ‚Ñƒ Ñ„Ð¾Ñ€Ð¼Ñƒ? Ð’ÑÐµ ÑÐ²ÑÐ·Ð°Ð½Ð½Ñ‹Ðµ Ð·Ð°ÑÐ²ÐºÐ¸ Ñ‚Ð°ÐºÐ¶Ðµ Ð±ÑƒÐ´ÑƒÑ‚ ÑƒÐ´Ð°Ð»ÐµÐ½Ñ‹."))try{(await fetch(`/api/admin/forms/${s}`,{method:"DELETE"})).ok?(alert("Ð¤Ð¾Ñ€Ð¼Ð° ÑƒÐ´Ð°Ð»ÐµÐ½Ð°"),i(),l()):alert("ÐžÑˆÐ¸Ð±ÐºÐ° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ")}catch(t){console.error("Delete error:",t),alert("ÐžÑˆÐ¸Ð±ÐºÐ° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ")}},h=async(s,t)=>{try{(await fetch(`/api/admin/forms/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_active:!t})})).ok&&i()}catch(n){console.error("Toggle active error:",n)}};return c?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[r&&e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:r.total_forms}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Ð’ÑÐµÐ³Ð¾ Ñ„Ð¾Ñ€Ð¼"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:r.active_forms}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"ÐÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ…"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:r.total_submissions}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Ð’ÑÐµÐ³Ð¾ Ð·Ð°ÑÐ²Ð¾Ðº"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e.jsx("div",{className:"text-3xl font-bold text-purple-600",children:r.submissions_today}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Ð—Ð°ÑÐ²Ð¾Ðº ÑÐµÐ³Ð¾Ð´Ð½Ñ"})]})]}),d.length===0?e.jsxs("div",{className:"bg-white p-12 rounded-lg border-2 border-dashed border-gray-300 text-center",children:[e.jsx("p",{className:"text-gray-500 mb-4",children:"Ð£ Ð²Ð°Ñ Ð¿Ð¾ÐºÐ° Ð½ÐµÑ‚ Ñ„Ð¾Ñ€Ð¼"}),e.jsx("a",{href:"/admin/forms/telegram/new",className:"text-blue-600 hover:underline",children:"Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¿ÐµÑ€Ð²ÑƒÑŽ Ñ„Ð¾Ñ€Ð¼Ñƒ"})]}):e.jsx("div",{className:"grid gap-4",children:d.map(s=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:s.title}),s.is_active?e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:"ÐÐºÑ‚Ð¸Ð²Ð½Ð°"}):e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded-full",children:"ÐÐµÐ°ÐºÑ‚Ð¸Ð²Ð½Ð°"})]}),s.description&&e.jsx("p",{className:"text-gray-600 mb-3",children:s.description}),e.jsxs("div",{className:"flex gap-4 text-sm text-gray-500",children:[e.jsxs("div",{children:["ðŸ“ ",s.fields?.length||0," Ð¿Ð¾Ð»ÐµÐ¹"]}),e.jsxs("div",{children:["ðŸ“¨ ",s.total_submissions||0," Ð·Ð°ÑÐ²Ð¾Ðº"]}),s.last_submission_at&&e.jsxs("div",{children:["ÐŸÐ¾ÑÐ»ÐµÐ´Ð½ÑÑ: ",new Date(s.last_submission_at).toLocaleDateString("ru-RU")]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("a",{href:`/admin/forms/telegram/${s.id}`,className:"px-4 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:"Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ"}),e.jsx("a",{href:`/admin/forms/telegram/${s.id}/submissions`,className:"px-4 py-2 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200",children:"Ð—Ð°ÑÐ²ÐºÐ¸"}),e.jsx("button",{onClick:()=>h(s.id,s.is_active),className:"px-4 py-2 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200",children:s.is_active?"Ð”ÐµÐ°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ":"ÐÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ"}),e.jsx("button",{onClick:()=>g(s.id),className:"px-4 py-2 text-sm bg-red-100 text-red-700 rounded hover:bg-red-200",children:"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ"})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"text-sm text-gray-500",children:[e.jsx("strong",{children:"Web App URL: "}),e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded text-xs",children:typeof window<"u"&&`${window.location.origin}/telegram-app?form_id=${s.id}`})]})})]},s.id))})]})}export{u as default};
